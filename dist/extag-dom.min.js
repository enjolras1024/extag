!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ExtagDOM=t()}(this,function(){"use strict";var r=Array.prototype.slice,s=Object.prototype.hasOwnProperty,n=function(e){var t,l,r,n=arguments.length;for(r=1;r<n;++r)if((t=arguments[r])instanceof Object)for(l in t)s.call(t,l)&&(e[l]=t[l]);return e},p={accept:null,acceptCharset:{attributeName:"accept-chartset"},accessKey:null,action:null,allowFullscreen:{isBoolProperty:!0,mustUseProperty:!0},allowTransparency:null,alt:null,async:{isBoolProperty:!0,mustUseProperty:!0},autocomplete:null,autofocus:{isBoolProperty:!0},autoplay:{isBoolProperty:!0},capture:{isBoolProperty:!0,mustUseProperty:!0},cellPadding:null,cellSpacing:null,charset:null,challenge:null,checked:{isBoolProperty:!0,mustUseProperty:!0},cite:null,classid:null,className:{attributeName:"class"},cols:null,colSpan:null,content:null,contentEditable:null,contextMenu:null,controls:{isBoolProperty:!0,mustUseProperty:!0},coords:null,crossOrigin:null,data:{mustUseProperty:!0},dateTime:null,default:{isBoolProperty:!0,mustUseProperty:!0},defer:{isBoolProperty:!0,mustUseProperty:!0},dir:null,disabled:{isBoolProperty:!0,mustUseProperty:!0},download:null,draggable:null,enctype:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:{isBoolProperty:!0,mustUseProperty:!0},formTarget:null,frameBorder:null,headers:null,height:null,hidden:{isBoolProperty:!0,mustUseProperty:!0},high:null,href:null,hreflang:null,htmlFor:{attributeName:"for"},httpEquiv:null,icon:null,id:null,innerHTML:{attributeName:"",mustUseProperty:!0},inputMode:null,integrity:null,is:null,keyparams:null,keytype:null,kind:null,label:null,lang:null,list:null,loop:{isBoolProperty:!0,mustUseProperty:!0},low:null,manifest:null,marginHeight:null,marginWidth:null,max:null,maxLength:null,media:null,mediaGroup:null,method:null,min:null,minLength:null,multiple:{isBoolProperty:!0,mustUseProperty:!0},muted:{isBoolProperty:!0,mustUseProperty:!0},name:null,nonce:null,noValidate:{isBoolProperty:!0,mustUseProperty:!0},open:{isBoolProperty:!0,mustUseProperty:!0},optimum:null,pattern:null,placeholder:null,poster:null,preload:null,profile:null,radiogroup:null,readOnly:{isBoolProperty:!0,mustUseProperty:!0},referrerPolicy:null,rel:null,required:{isBoolProperty:!0,mustUseProperty:!0},reversed:{isBoolProperty:!0,mustUseProperty:!0},role:null,rows:null,rowSpan:null,sandbox:null,scope:null,scoped:{isBoolProperty:!0,mustUseProperty:!0},scrolling:null,seamless:{isBoolProperty:!0,mustUseProperty:!0},selected:{isBoolProperty:!0,mustUseProperty:!0},shape:null,size:null,sizes:null,span:null,spellcheck:null,src:null,srcdoc:null,srclang:null,srcset:null,start:null,step:null,style:null,summary:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:{mustUseProperty:!0},width:null,wmode:null,wrap:null,about:null,datatype:null,inlist:null,prefix:null,property:null,resource:null,typeof:null,vocab:null,autocapitalize:null,autocorrect:null,autosave:null,color:null,itemprop:null,itemscope:{isBoolProperty:!0,mustUseProperty:!0},itemtype:null,itemid:null,itemref:null,results:null,security:null,unselectable:null};!function(){var e,t,l={};for(e in p)(t=p[e])||(t=p[e]={}),t.propertyName=e,null==t.attributeName&&(t.attributeName=e.toLowerCase()),t.attributeName&&t.attributeName!==e&&(l[t.attributeName]=t);n(p,l)}();var y={html:"http://www.w3.org/1999/xhtml",math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},o=/-([a-z])?/g,u=function(e,t){return t?t.toUpperCase():""},a={};var i=/\s+/;function c(e){if(e){var t=typeof e;if("string"===t)return e.trim().split(i);if("object"===t){var l=[];for(var r in e)e[r]&&l.push(r);return l}}}function f(e){var t=e.tagName;return t?t.toLowerCase():""}function m(e){return 1!==e.nodeType?"":function(e){{if(!e||e===y.html)return"";if(e===y.svg)return"svg";if(e===y.math)return"math";if(e===y.xlink)return"xlink"}return null}(e.namespaceURI||e.getAttribute("xmlns"))}function h(e){return e&&e.__extag_shell__}function d(e,t){t?e.__extag_shell__=t:delete e.__extag_shell__}var v={},_=!1;try{var e=Object.defineProperty({},"passive",{get:function(){return _=!0}});window.addEventListener("test-passive",null,e)}catch(e){}var g=0,P=3,w=(Object.freeze({}),[]);var b,x=["webkit","Webkit","Moz","ms","O"];var U={float:"cssFloat"};function B(e,t){if(e in U)return U[e];var l=function(e){if(e.indexOf("-")<0)return e;if(e in a)return a[e];var t=e.replace(o,u);return a[e]=t}(e);return l in t?U[e]=l:(l=l.charAt(0).toUpperCase()+l.slice(1),b||(b=function(e,t){for(var l=0;l<x.length;++l)if(x[l]+e in t)return x[l]}(l,t)),b&&(l=b+l)in t?U[e]=l:void 0)}function N(e,t){var l,r,n,o,u=t.$meta;return u.type===P?13===e.nodeType:!(u.tag!==f(e)||u.ns!==m(e)||(n=e,((o=t._props)&&o.id)!=n.getAttribute("id"))||!function(e,t){var l=t._classes,r=e.getAttribute("class"),n=l&&l._props;if(r&&!n)return!1;var o=c(r)||w,u=c(n)||w;return o.length===u.length&&(1===u.length?o[0]===u[0]:o.sort().join(" ")===u.sort().join(" "))}(e,t)||"input"===u.tag&&(l=e,((r=t._props)&&r.type||"text")!==(l.getAttribute("type")||"text")))||void 0}function A(e){for(var t=f(e),l=e.attributes,r=l.length-1;0<=r;--r){var n=l[r],o=n.name;if("id"!==o&&"class"!==o&&("type"!==o||"input"!==t)){var u=p[o];u&&u.mustUseProperty?u.isBoolProperty?e[o]=!1:e[o]="":n.namespaceURI?e.removeAttributeNS(n.namespaceURI,o):e.removeAttribute(o)}}}function E(e,t,l){if(t.$meta.type!==g){var r,n,o,u,a,i,s;l=function e(t,l){var r,n,o=t.length;for(l=l||[],r=0;r<o;++r)(n=t[r]).$meta.type===g?n._children&&e(n._children,l):l.push(n);return l}(l);var p,c,f,m=e.childNodes;if(n=l.length,o=m.length)for(r=o-1;0<=r;--r)(a=h(s=m[r]))&&t!==a.getParent(!0)&&e.removeChild(s);if(n){for(r=0;r<n;++r)(u=l[r]).$skin&&(u.__extag_index__=r);for(r=0;r<n;++r){if(i=(u=l[r]).$skin,a=(s=m[r])?h(s):null,!i){var d=u.$meta;s&&!a&&N(s,u)?A(i=s):(p=d.type,c=d.tag,f=d.ns,i=p===P?document.createTextNode(""):f?document.createElementNS(y[f],c):document.createElement(c)),u.attach(i)}s?i!==s&&(e.insertBefore(i,s),a&&a.__extag_index__?e.insertBefore(s,m[a.__extag_index__]||null):e.removeChild(s)):e.appendChild(i)}}}}function k(e,t){if(t){var l,r={};for(l in n(r,e),t)null==r[l]&&(r[l]=t[l]);return r}return e}function L(e,t){return t?n({},t,e):e}var t={query:function(e,t){return(t||document).querySelector(e)},invoke:function(e,t){var l=e[t];return arguments.length<3?l.call(e):l.apply(e,r.call(arguments,2))},attachShell:function(e,t){var l=h(e);if(l){if(l===t)return;throw new Error("a shell can not attach a $skin that has been attached")}var r=t.$meta;if(1===r.type&&r.tag!==f(e))throw new Error("a shell can not attach a $skin that has a different tag");if(r.ns!==m(e))throw new Error("a shell can not attach a $skin that has a different namespace");d(e,t)},detachShell:function(e,t){h(e)===t&&d(e,null)},renderShell:function(e,t){if(h(e)!==t)throw new Error("the shell is not attached to this $skin");var l=t.$meta;if(l.type===P)t._dirty&&(e.nodeValue=t._content);else if(1===l.type){var r,n;r=t._props,n=t._dirty,t.__props&&(r=k(r,t.__props._props),n=L(n,t.__props._dirty)),r&&n&&function(e,t,l){var r,n,o,u,a;for(r in l)s.call(l,r)&&(u=t[r],(n=p[r])?n.mustUseProperty?e[n.propertyName]=u:null!=u?e.setAttribute(n.attributeName,u):e.removeAttribute(n.attributeName):(a=(o=r.indexOf(":"))<=0?null:y[r.slice(0,o)])?(r=r.slice(o+1),null!=u?e.setAttributeNS(a,r,u):e.removeAttributeNS(a,r)):(o<=0||"x"!==r.slice(0,o))&&(null!=u?e.setAttribute(r,u):e.removeAttribute(r)))}(e,r,n);var o=r.shadowMode,u=t._style,a=t._classes,i=t._children;n=u?(r=u._props,u._dirty):r=null,t.__style&&(r=k(r,t.__style._props),n=L(n,t.__style._dirty)),r&&n&&function(e,t,l){var r,n,o=e.style;for(r in l)s.call(l,r)&&("--"===r.slice(0,2)?o.setProperty(r,t[r]):(n=B(r,o))&&(o[n]=t[r]))}(e,r,n),n=a?(r=a._props,a._dirty):r=null,t.__classes&&(r=k(r,t.__classes._props),n=L(n,t.__classes._dirty)),r&&n&&function(e,t,l){var r,n=e.classList;if(n)for(r in l)s.call(l,r)&&(t[r]?n.add(r):n.remove(r));else{var o=[];for(r in t)s.call(t,r)&&t[r]&&o.push(r);e.setAttribute("class",o.join(" "))}}(e,r,n),i&&2&t.$flag&&(o&&e.attachShadow?(null==e.shadowRoot&&e.attachShadow({mode:o}),E(e.shadowRoot,t,i)):E(e,t,i)),t._commands&&4&t.$flag&&function(e,t){for(var l=0,r=t.length;l<r;++l){var n=t[l];if(n&&n.name){var o=e[n.name];"function"==typeof o&&o.apply(e,n.args||w)}}}(e,t._commands)}},hasNameSpace:function(e){return s.call(y,e)},mayDispatchEvent:function(e,t){var l=e.tagName;if(!l)return!1;var r=v[l]||{};if(t in r)return r[t];r[t]=!1,v[l]=r;var n,o="on"+t;if(o in e)if("function"==typeof e[o])r[t]=!0;else{n=e.getAttribute(o);try{e.setAttribute(o,"void 0"),"function"==typeof e[o]&&(e[o]=null,r[t]=!0)}catch(e){r[t]=!1}n?e.setAttribute(o,n):e.removeAttribute(o)}return r[t]},addEventListener:function(e,t,l,r){r?r.passive?e.addEventListener(t,l,_?r:!!r.capture):e.addEventListener(t,l,!!r.capture):e.addEventListener(t,l)},removeEventListener:function(e,t,l,r){e.removeEventListener(t,l,!!r&&!!r.capture)}};return window.Extag&&window.Extag.conf("view-engine",t),t});
