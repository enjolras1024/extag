!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ExtagDom=t()}(this,function(){"use strict";function l(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");var t,r,n,l=arguments.length;for(n=1;n<l;++n)if((t=arguments[n])instanceof Object)for(r in t)t.hasOwnProperty(r)&&Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));return e}var o=!1;try{var e=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("test-passive",null,e)}catch(e){}var a={},s={accept:null,acceptCharset:{attributeName:"accept-chartset"},accessKey:null,action:null,allowFullscreen:{isBoolProperty:!0,mustUseProperty:!0},allowTransparency:null,alt:null,async:{isBoolProperty:!0,mustUseProperty:!0},autocomplete:null,autofocus:{isBoolProperty:!0},autoplay:{isBoolProperty:!0},capture:{isBoolProperty:!0,mustUseProperty:!0},cellPadding:null,cellSpacing:null,charset:null,challenge:null,checked:{isBoolProperty:!0,mustUseProperty:!0},cite:null,classid:null,className:{attributeName:"class"},cols:null,colSpan:null,content:null,contentEditable:null,contextMenu:null,controls:{isBoolProperty:!0,mustUseProperty:!0},coords:null,crossOrigin:null,data:{mustUseProperty:!0},dateTime:null,default:{isBoolProperty:!0,mustUseProperty:!0},defer:{isBoolProperty:!0,mustUseProperty:!0},dir:null,disabled:{isBoolProperty:!0,mustUseProperty:!0},download:null,draggable:null,enctype:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:{isBoolProperty:!0,mustUseProperty:!0},formTarget:null,frameBorder:null,headers:null,height:null,hidden:{isBoolProperty:!0,mustUseProperty:!0},high:null,href:null,hreflang:null,htmlFor:{attributeName:"for"},httpEquiv:null,icon:null,id:null,innerHTML:{attributeName:"inner-html",mustUseProperty:!0},inputMode:null,integrity:null,is:null,keyparams:null,keytype:null,kind:null,label:null,lang:null,list:null,loop:{isBoolProperty:!0,mustUseProperty:!0},low:null,manifest:null,marginHeight:null,marginWidth:null,max:null,maxLength:null,media:null,mediaGroup:null,method:null,min:null,minLength:null,multiple:{isBoolProperty:!0,mustUseProperty:!0},muted:{isBoolProperty:!0,mustUseProperty:!0},name:null,nonce:null,noValidate:{isBoolProperty:!0,mustUseProperty:!0},open:{isBoolProperty:!0,mustUseProperty:!0},optimum:null,pattern:null,placeholder:null,poster:null,preload:null,profile:null,radiogroup:null,readOnly:{isBoolProperty:!0,mustUseProperty:!0},referrerPolicy:null,rel:null,required:{isBoolProperty:!0,mustUseProperty:!0},reversed:{isBoolProperty:!0,mustUseProperty:!0},role:null,rows:null,rowSpan:null,sandbox:null,scope:null,scoped:{isBoolProperty:!0,mustUseProperty:!0},scrolling:null,seamless:{isBoolProperty:!0,mustUseProperty:!0},selected:{isBoolProperty:!0,mustUseProperty:!0},shape:null,size:null,sizes:null,span:null,spellcheck:null,src:null,srcdoc:null,srclang:null,srcset:null,start:null,step:null,style:null,summary:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:{mustUseProperty:!0},width:null,wmode:null,wrap:null,about:null,datatype:null,inlist:null,prefix:null,property:null,resource:null,typeof:null,vocab:null,autocapitalize:null,autocorrect:null,autosave:null,color:null,itemprop:null,itemscope:{isBoolProperty:!0,mustUseProperty:!0},itemtype:null,itemid:null,itemref:null,results:null,security:null,unselectable:null},u=function(e){var t,r,n={};for(t in e)(r=e[t])&&r.attributeName?n[t]=r.attributeName:n[t]=t.toLowerCase();return n}(s);u.cssFloat="float";var i,p=function(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[e[t]]=t);return r}(u),c={html:"http://www.w3.org/1999/xhtml",math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},n=["webkit","Webkit","Moz","ms","O"];function m(e,t){for(var r=0;r<n.length;++r)if(n[r]+t in e)return n[r]}var f=window.document,t=/-([a-z])?/g,r=/([A-Z])/g,d=function(e,t){return t?t.toUpperCase():""},h=function(e,t){return"-"+t.toLowerCase()};function y(e){return e in u?u[e]:r.test(e)?e.replace(r,h):e}function g(e,t){var r,n,l=e.length;for(t=t||[],r=0;r<l;++r)0===(n=e[r]).$type?n._children&&g(n._children,t):t.push(n);return t}function P(e,t){if(t){var r,n={};for(r in l(n,e),t)null==n[r]&&(n[r]=t[r]);return n}return e}function v(e,t){return t?l({},t,e):e}var _=Array.prototype.slice;function w(){var e=arguments[0];if(e&&this[e])return this[e].apply(this,_.call(arguments,1))}return l(w,{version:"0.2.0",toCamelCase:function(e){return e in p?p[e]:e.indexOf("-")<0?e:e.replace(t,d)},toKebabCase:y,isBoolProp:function(e){var t=s[e];return t&&t.isBoolProperty},isText:function(e){return!!e&&3===e.nodeType},isComment:function(e){return!!e&&8===e.nodeType},isElement:function(e){return!!e&&1===e.nodeType},createText:function(e){return f.createTextNode(e)},createElement:function(e,t,r){return e?f.createElementNS(c[e],t):f.createElement(t)},createFragment:function(){return f.createDocumentFragment()},getTagName:function(e){var t=e.tagName;return t?t.toLowerCase():""},getNameSpace:function(e){if(w.isElement(e)){var t=e.namespaceURI||e.getAttribute("xmlns");return w.toNameSpace(t)}return""},hasNameSpace:function(e){return c.hasOwnProperty(e)},toNameSpace:function(e){return e&&e!==c.html?e===c.svg?"svg":e===c.math?"math":e===c.xlink?"xlink":null:""},toTemplate:function(e,t){if(!w.isElement(e))return null;var r={};r.ns=w.getNameSpace(e),r.tagName=w.getTagName(e);var n=w.getAttrs(e);n&&(r.attributes=n);var l,o,a,u=w.getChildren(e);if(u.length)for(r.children=[],l=0,o=u.length;l<o;++l)a=u[l],w.isText(a)?r.children.push(w.getProp(a,"data")):w.isElement(a)?r.children.push(w.toTemplate(a,e)):w.isComment(a)&&r.children.push({ns:"",tagName:"!",comment:w.getProp(a,"data")});return r},toOuterHTML:function(e){return e.outerHTML},getAttrs:function(e){if(w.isElement(e)&&e.hasAttributes()){for(var t,r,n,l={},o=e.attributes,a=0,u=o.length;a<u;++a)r=(t=o[a]).namespaceURI?w.toNameSpace(t.namespaceURI)+":"+t.name:t.name,p.hasOwnProperty(r)&&(n=s[p[r]])&&n.isBoolProperty?l[r]="true":l[r]=t.value;return l}},hasProp:function(e,t){return t in e},getProp:function(e,t){return e[t]},getChildren:function(e){var t=[],r=e.childNodes;return r&&r.length&&t.push.apply(t,r),t},getParent:function(e){return e.parentNode},getShell:function(e){return e&&e.__extag_shell__},setShell:function(e,t){t?Object.defineProperty(e,"__extag_shell__",{value:t,writable:!0,enumerable:!1,configurable:!0}):delete e.__extag_shell__},attachShell:function(e,t){var r=w.getShell(e);if(r){if(r===t)return;throw new Error("a shell can not attach a $skin that has been attached")}if(1===t.$type&&t.tag!==w.getTagName(e))throw new Error("a shell can not attach a $skin that has a different tag");if(t.ns!==w.getNameSpace(e))throw new Error("a shell can not attach a $skin that has a different namespace");w.setShell(e,t)},detachShell:function(e,t){w.getShell(e)===t&&w.setShell(e,null)},query:function(e,t){return(t||f).querySelector(e)},invoke:function(e,t,r){e[t].apply(e,r)},mayDispatchEvent:function(e,t){var r=e.tagName;if(!r)return!1;var n=a[r]||{};if(t in n)return!0;a[r]=n;var l,o="on"+t;if(o in e){if("function"==typeof e[o])return!0;l=e.getAttribute(o);try{e.setAttribute(o,"return;"),"function"==typeof e[o]&&(e[o]=null,n[t]=!0)}catch(e){}l?e.setAttribute(o,l):e.removeAttribute(o)}return t in n},addEventListener:function(e,t,r,n){n?e.addEventListener(t,r,o?n:!!n.capture):e.addEventListener(t,r,!1)},removeEventListener:function(e,t,r,n){e.removeEventListener(t,r,!!n&&!!n.capture)},renderShell:function(e,t){if(w.getShell(e)!==t)throw new Error("the shell is not attached to this $skin");var r,n;if(r=t._props,n=t._dirty,t.__props&&(r=P(r,t.__props._props),n=v(n,t.__props._dirty)),r&&n&&w.renderProps(e,r,n),t.tag){var l,o=r.shadowMode,a=t._attrs,u=t._style,s=t._classes,i=t._children;if(1===t.$type&&(n=a?(r=a._props,a._dirty):r=null,t.__attrs&&(r=P(r,t.__attrs&&t.__attrs._props),n=v(n,t.__attrs&&t.__attrs._dirty)),r&&n&&w.renderAttrs(e,r,n),n=u?(r=u._props,u._dirty):r=null,t.__style&&(r=P(r,t.__style._props),n=v(n,t.__style._dirty)),r&&n&&w.renderStyle(e,r,n),n=s?(r=s._props,s._dirty):r=null,t.__classes&&(r=P(r,t.__classes._props),n=v(n,t.__classes._dirty)),r&&n&&w.renderClasses(e,r,n)),i&&2&t.$flag)if((l=o&&e.attachShadow?(null==e.shadowRoot&&e.attachShadow({mode:o}),w.renderChildren(e.shadowRoot,t,g(i))):w.renderChildren(e,t,g(i)))&&l.length)for(var p=0,c=l.length;p<c;++p){var m=w.getParent(l[p]),f=w.getShell(l[p]);!m&&f&&f.detach()}t._commands&&w.invokeCommands(e,t._commands)}},renderAttrs:function(e,t,r){var n,l,o,a;for(n in r)r.hasOwnProperty(n)&&(l=t[n],0<(o=n.indexOf(":"))&&(a=c[n.slice(0,o)]),a?(n=n.slice(o+1),null!=l?e.setAttributeNS(a,n,l):e.removeAttributeNS(a,n)):null!=l?e.setAttribute(n,l):e.removeAttribute(n))},renderProps:function(e,t,r){var n,l,o;for(n in r)r.hasOwnProperty(n)&&(l=s[n],o=t[n],l?l.mustUseProperty?e[n]=o:null!=o?e.setAttribute(u[n],o):e.removeAttribute(u[n]):null!=o?e.setAttribute(y(n),o):e.removeAttribute(y(n)))},renderStyle:function(e,t,r){var n,l=e.style;for(n in r)if(r.hasOwnProperty(n))if(n in l)l[n]=t[n];else if("--"===n.slice(0,2))l.setProperty(n,t[n]);else{var o=n.charAt(0).toUpperCase()+n.slice(1);i||(i=m(l,o)),i&&(l[i+o]=t[n])}},renderClasses:function(e,t,r){var n,l=e.classList;if(l)for(n in r)r.hasOwnProperty(n)&&(t[n]?l.add(n):l.remove(n));else{var o=[];for(n in t)t.hasOwnProperty(n)&&t[n]&&o.push(n);e.setAttribute("class",o.join(" "))}},invokeCommands:function(e,t){for(var r=0,n=t.length;r<n;++r){var l=t[r];console.log(l.name,l.args),w.invoke(e,l.name,l.args)}},renderChildren:function(e,t,r){if(0!==t.$type){var n,l,o,a,u,s,i,p,c=e.childNodes;if(l=r.length)for(n=0;n<l;++n){if(s=(a=r[n]).$skin,i=c[n],!s){var m,f=a.ns,d=a.tag,h=a.$type;s=!i||d!==w.getTagName(i)||f!==w.getNameSpace(i)||(m=i?w.getShell(i):null)&&m!==a?1===h?w.createElement(f,d,a._props&&a._props.type):w.createText(""):i,a.attach(s)}i?s!==i&&e.insertBefore(s,i):e.appendChild(s)}if(l<(o=c.length))for(p=[],n=o-1;l<=n;--n)u=c[n],p.push(u),e.removeChild(u);return p}}}),"undefined"!=typeof window&&window.Extag&&Extag.conf("view-engine",w),w});
