!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ExtagDom=t()}(this,function(){"use strict";var s=Object.prototype.hasOwnProperty;function l(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");var t,r,n,l=arguments.length;for(n=1;n<l;++n)if((t=arguments[n])instanceof Object)for(r in t)s.call(t,r)&&Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));return e}var o=!1;try{var e=Object.defineProperty({},"passive",{get:function(){return o=!0}});window.addEventListener("test-passive",null,e)}catch(e){}var a={},i={accept:null,acceptCharset:{attributeName:"accept-chartset"},accessKey:null,action:null,allowFullscreen:{isBoolProperty:!0,mustUseProperty:!0},allowTransparency:null,alt:null,async:{isBoolProperty:!0,mustUseProperty:!0},autocomplete:null,autofocus:{isBoolProperty:!0},autoplay:{isBoolProperty:!0},capture:{isBoolProperty:!0,mustUseProperty:!0},cellPadding:null,cellSpacing:null,charset:null,challenge:null,checked:{isBoolProperty:!0,mustUseProperty:!0},cite:null,classid:null,className:{attributeName:"class"},cols:null,colSpan:null,content:null,contentEditable:null,contextMenu:null,controls:{isBoolProperty:!0,mustUseProperty:!0},coords:null,crossOrigin:null,data:{mustUseProperty:!0},dateTime:null,default:{isBoolProperty:!0,mustUseProperty:!0},defer:{isBoolProperty:!0,mustUseProperty:!0},dir:null,disabled:{isBoolProperty:!0,mustUseProperty:!0},download:null,draggable:null,enctype:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:{isBoolProperty:!0,mustUseProperty:!0},formTarget:null,frameBorder:null,headers:null,height:null,hidden:{isBoolProperty:!0,mustUseProperty:!0},high:null,href:null,hreflang:null,htmlFor:{attributeName:"for"},httpEquiv:null,icon:null,id:null,innerHTML:{attributeName:"inner-html",mustUseProperty:!0},inputMode:null,integrity:null,is:null,keyparams:null,keytype:null,kind:null,label:null,lang:null,list:null,loop:{isBoolProperty:!0,mustUseProperty:!0},low:null,manifest:null,marginHeight:null,marginWidth:null,max:null,maxLength:null,media:null,mediaGroup:null,method:null,min:null,minLength:null,multiple:{isBoolProperty:!0,mustUseProperty:!0},muted:{isBoolProperty:!0,mustUseProperty:!0},name:null,nonce:null,noValidate:{isBoolProperty:!0,mustUseProperty:!0},open:{isBoolProperty:!0,mustUseProperty:!0},optimum:null,pattern:null,placeholder:null,poster:null,preload:null,profile:null,radiogroup:null,readOnly:{isBoolProperty:!0,mustUseProperty:!0},referrerPolicy:null,rel:null,required:{isBoolProperty:!0,mustUseProperty:!0},reversed:{isBoolProperty:!0,mustUseProperty:!0},role:null,rows:null,rowSpan:null,sandbox:null,scope:null,scoped:{isBoolProperty:!0,mustUseProperty:!0},scrolling:null,seamless:{isBoolProperty:!0,mustUseProperty:!0},selected:{isBoolProperty:!0,mustUseProperty:!0},shape:null,size:null,sizes:null,span:null,spellcheck:null,src:null,srcdoc:null,srclang:null,srcset:null,start:null,step:null,style:null,summary:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:{mustUseProperty:!0},width:null,wmode:null,wrap:null,about:null,datatype:null,inlist:null,prefix:null,property:null,resource:null,typeof:null,vocab:null,autocapitalize:null,autocorrect:null,autosave:null,color:null,itemprop:null,itemscope:{isBoolProperty:!0,mustUseProperty:!0},itemtype:null,itemid:null,itemref:null,results:null,security:null,unselectable:null},u=function(e){var t,r,n={};for(t in e)(r=e[t])&&r.attributeName?n[t]=r.attributeName:n[t]=t.toLowerCase();return n}(i);u.cssFloat="float";var c,p=function(e){var t,r={};for(t in e)s.call(e,t)&&(r[e[t]]=t);return r}(u),f={html:"http://www.w3.org/1999/xhtml",math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},n=["webkit","Webkit","Moz","ms","O"];function m(e,t){for(var r=0;r<n.length;++r)if(n[r]+t in e)return n[r]}var r=window.document,t=/-([a-z])?/g,d=/([A-Z])/g,h=function(e,t){return t?t.toUpperCase():""},y=function(e,t){return"-"+t.toLowerCase()};function g(e){return e in u?u[e]:d.test(e)?e.replace(d,y):e}function v(e,t){var r,n,l=e.length;for(t=t||[],r=0;r<l;++r)0===(n=e[r]).$type?n._children&&v(n._children,t):t.push(n);return t}function P(e,t){if(t){var r,n={};for(r in l(n,e),t)null==n[r]&&(n[r]=t[r]);return n}return e}function _(e,t){return t?l({},t,e):e}var w=Array.prototype.slice;function b(){var e=arguments[0];if(e&&this[e])return this[e].apply(this,w.call(arguments,1))}return l(b,{version:"0.2.1",toCamelCase:function(e){return e in p?p[e]:e.indexOf("-")<0?e:e.replace(t,h)},toKebabCase:g,isBoolProp:function(e){var t=i[e];return t&&t.isBoolProperty},isText:function(e){return!!e&&3===e.nodeType},isComment:function(e){return!!e&&8===e.nodeType},isElement:function(e){return!!e&&1===e.nodeType},createText:function(e){return r.createTextNode(e)},createElement:function(e,t){return e?r.createElementNS(f[e],t):r.createElement(t)},createFragment:function(){return r.createDocumentFragment()},getTagName:function(e){var t=e.tagName;return t?t.toLowerCase():""},getNameSpace:function(e){if(b.isElement(e)){var t=e.namespaceURI||e.getAttribute("xmlns");return b.toNameSpace(t)}return""},hasNameSpace:function(e){return s.call(f,e)},toNameSpace:function(e){return e&&e!==f.html?e===f.svg?"svg":e===f.math?"math":e===f.xlink?"xlink":null:""},toTemplate:function(e){if(!b.isElement(e))return null;var t={};t.ns=b.getNameSpace(e),t.tagName=b.getTagName(e);var r=b.getAttrs(e);r&&(t.attributes=r);var n,l,o,a=b.getChildren(e);if(a.length)for(t.children=[],n=0,l=a.length;n<l;++n)o=a[n],b.isText(o)?t.children.push(b.getProp(o,"data")):b.isElement(o)?t.children.push(b.toTemplate(o,e)):b.isComment(o)&&t.children.push({ns:"",tagName:"!",comment:b.getProp(o,"data")});return t},toOuterHTML:function(e){return e.outerHTML},getAttrs:function(e){if(b.isElement(e)&&e.hasAttributes()){for(var t,r,n,l={},o=e.attributes,a=0,u=o.length;a<u;++a)r=(t=o[a]).namespaceURI?b.toNameSpace(t.namespaceURI)+":"+t.name:t.name,s.call(p,r)&&(n=i[p[r]])&&n.isBoolProperty?l[r]="true":l[r]=t.value;return l}},hasProp:function(e,t){return t in e},getProp:function(e,t){return e[t]},getChildren:function(e){var t=[],r=e.childNodes;return r&&r.length&&t.push.apply(t,r),t},getParent:function(e){return e.parentNode},getShell:function(e){return e&&e.__extag_shell__},setShell:function(e,t){t?Object.defineProperty(e,"__extag_shell__",{value:t,writable:!0,enumerable:!1,configurable:!0}):delete e.__extag_shell__},attachShell:function(e,t){var r=b.getShell(e);if(r){if(r===t)return;throw new Error("a shell can not attach a $skin that has been attached")}if(1===t.$type&&t.tag!==b.getTagName(e))throw new Error("a shell can not attach a $skin that has a different tag");if(t.ns!==b.getNameSpace(e))throw new Error("a shell can not attach a $skin that has a different namespace");b.setShell(e,t)},detachShell:function(e,t){b.getShell(e)===t&&b.setShell(e,null)},query:function(e,t){return(t||r).querySelector(e)},invoke:function(e,t,r){e[t].apply(e,r)},mayDispatchEvent:function(e,t){var r=e.tagName;if(!r)return!1;var n=a[r]||{};if(t in n)return!0;a[r]=n;var l,o="on"+t;if(o in e){if("function"==typeof e[o])return!0;l=e.getAttribute(o);try{e.setAttribute(o,"return;"),"function"==typeof e[o]&&(e[o]=null,n[t]=!0)}catch(e){}l?e.setAttribute(o,l):e.removeAttribute(o)}return t in n},addEventListener:function(e,t,r,n){n?e.addEventListener(t,r,o?n:!!n.capture):e.addEventListener(t,r,!1)},removeEventListener:function(e,t,r,n){e.removeEventListener(t,r,!!n&&!!n.capture)},renderShell:function(e,t){if(b.getShell(e)!==t)throw new Error("the shell is not attached to this $skin");var r,n;if(r=t._props,n=t._dirty,t.__props&&(r=P(r,t.__props._props),n=_(n,t.__props._dirty)),r&&n&&b.renderProps(e,r,n),t.tag){var l,o=r.shadowMode,a=t._attrs,u=t._style,s=t._classes,i=t._children;if(1===t.$type&&(n=a?(r=a._props,a._dirty):r=null,t.__attrs&&(r=P(r,t.__attrs&&t.__attrs._props),n=_(n,t.__attrs&&t.__attrs._dirty)),r&&n&&b.renderAttrs(e,r,n),n=u?(r=u._props,u._dirty):r=null,t.__style&&(r=P(r,t.__style._props),n=_(n,t.__style._dirty)),r&&n&&b.renderStyle(e,r,n),n=s?(r=s._props,s._dirty):r=null,t.__classes&&(r=P(r,t.__classes._props),n=_(n,t.__classes._dirty)),r&&n&&b.renderClasses(e,r,n)),i&&2&t.$flag)if((l=o&&e.attachShadow?(null==e.shadowRoot&&e.attachShadow({mode:o}),b.renderChildren(e.shadowRoot,t,v(i))):b.renderChildren(e,t,v(i)))&&l.length)for(var c=0,p=l.length;c<p;++c){var f=b.getParent(l[c]),m=b.getShell(l[c]);!f&&m&&m.detach()}t._commands&&b.invokeCommands(e,t._commands)}},renderAttrs:function(e,t,r){var n,l,o,a;for(n in r)s.call(r,n)&&(l=t[n],0<(o=n.indexOf(":"))&&(a=f[n.slice(0,o)]),a?(n=n.slice(o+1),null!=l?e.setAttributeNS(a,n,l):e.removeAttributeNS(a,n)):null!=l?e.setAttribute(n,l):e.removeAttribute(n))},renderProps:function(e,t,r){var n,l,o;for(n in r)s.call(r,n)&&(l=i[n],o=t[n],l?l.mustUseProperty?e[n]=o:null!=o?e.setAttribute(u[n],o):e.removeAttribute(u[n]):null!=o?e.setAttribute(g(n),o):e.removeAttribute(g(n)))},renderStyle:function(e,t,r){var n,l=e.style;for(n in r)if(s.call(r,n))if(n in l)l[n]=t[n];else if("--"===n.slice(0,2))l.setProperty(n,t[n]);else{var o=n.charAt(0).toUpperCase()+n.slice(1);c||(c=m(l,o)),c&&(l[c+o]=t[n])}},renderClasses:function(e,t,r){var n,l=e.classList;if(l)for(n in r)s.call(r,n)&&(t[n]?l.add(n):l.remove(n));else{var o=[];for(n in t)s.call(t,n)&&t[n]&&o.push(n);e.setAttribute("class",o.join(" "))}},invokeCommands:function(e,t){for(var r=0,n=t.length;r<n;++r){var l=t[r];b.invoke(e,l.name,l.args)}},renderChildren:function(e,t,r){if(0!==t.$type){var n,l,o,a,u,s,i,c,p=e.childNodes;if(l=r.length)for(n=0;n<l;++n){if(s=(a=r[n]).$skin,i=p[n],!s){var f,m=a.ns,d=a.tag,h=a.$type;s=!i||d!==b.getTagName(i)||m!==b.getNameSpace(i)||(f=i?b.getShell(i):null)&&f!==a?1===h?b.createElement(m,d,a._props&&a._props.type):b.createText(""):i,a.attach(s)}i?s!==i&&e.insertBefore(s,i):e.appendChild(s)}if(l<(o=p.length))for(c=[],n=o-1;l<=n;--n)u=p[n],c.push(u),e.removeChild(u);return c}}}),"undefined"!=typeof window&&window.Extag&&window.Extag.conf("view-engine",b),b});
