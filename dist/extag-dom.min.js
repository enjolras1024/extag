!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ExtagDOM=t()}(this,function(){"use strict";var y=0,h=3,p=(Object.freeze({}),Object.freeze({}),Object.freeze([])),n=Array.prototype.slice,c=Object.prototype.hasOwnProperty,f={accept:null,acceptCharset:{attributeName:"accept-chartset"},accessKey:null,action:null,allowFullscreen:{isBoolProperty:!0,mustUseProperty:!0},allowTransparency:null,alt:null,async:{isBoolProperty:!0,mustUseProperty:!0},autocomplete:null,autofocus:{isBoolProperty:!0},autoplay:{isBoolProperty:!0},capture:{isBoolProperty:!0,mustUseProperty:!0},cellPadding:null,cellSpacing:null,charset:null,challenge:null,checked:{isBoolProperty:!0,mustUseProperty:!0},cite:null,classid:null,className:{attributeName:"class"},cols:null,colSpan:null,content:null,contentEditable:null,contextMenu:null,controls:{isBoolProperty:!0,mustUseProperty:!0},coords:null,crossOrigin:null,data:{mustUseProperty:!0},dateTime:null,default:{isBoolProperty:!0,mustUseProperty:!0},defer:{isBoolProperty:!0,mustUseProperty:!0},dir:null,disabled:{isBoolProperty:!0,mustUseProperty:!0},download:null,draggable:null,enctype:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:{isBoolProperty:!0,mustUseProperty:!0},formTarget:null,frameBorder:null,headers:null,height:null,hidden:{isBoolProperty:!0,mustUseProperty:!0},high:null,href:null,hreflang:null,htmlFor:{attributeName:"for"},httpEquiv:null,icon:null,id:null,innerHTML:{attributeName:"inner-html",mustUseProperty:!0},inputMode:null,integrity:null,is:null,keyparams:null,keytype:null,kind:null,label:null,lang:null,list:null,loop:{isBoolProperty:!0,mustUseProperty:!0},low:null,manifest:null,marginHeight:null,marginWidth:null,max:null,maxLength:null,media:null,mediaGroup:null,method:null,min:null,minLength:null,multiple:{isBoolProperty:!0,mustUseProperty:!0},muted:{isBoolProperty:!0,mustUseProperty:!0},name:null,nonce:null,noValidate:{isBoolProperty:!0,mustUseProperty:!0},open:{isBoolProperty:!0,mustUseProperty:!0},optimum:null,pattern:null,placeholder:null,poster:null,preload:null,profile:null,radiogroup:null,readOnly:{isBoolProperty:!0,mustUseProperty:!0},referrerPolicy:null,rel:null,required:{isBoolProperty:!0,mustUseProperty:!0},reversed:{isBoolProperty:!0,mustUseProperty:!0},role:null,rows:null,rowSpan:null,sandbox:null,scope:null,scoped:{isBoolProperty:!0,mustUseProperty:!0},scrolling:null,seamless:{isBoolProperty:!0,mustUseProperty:!0},selected:{isBoolProperty:!0,mustUseProperty:!0},shape:null,size:null,sizes:null,span:null,spellcheck:null,src:null,srcdoc:null,srclang:null,srcset:null,start:null,step:null,style:null,summary:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:{mustUseProperty:!0},width:null,wmode:null,wrap:null,about:null,datatype:null,inlist:null,prefix:null,property:null,resource:null,typeof:null,vocab:null,autocapitalize:null,autocorrect:null,autosave:null,color:null,itemprop:null,itemscope:{isBoolProperty:!0,mustUseProperty:!0},itemtype:null,itemid:null,itemref:null,results:null,security:null,unselectable:null};!function(){var e,t,r={};for(e in f)(t=f[e])||(t=f[e]={}),t.propertyName=e,null==t.attributeName&&(t.attributeName=e.toLowerCase()),t.attributeName&&t.attributeName!==e&&(r[t.attributeName]=t);!function(e){var t,r,n,l=arguments.length;for(n=1;n<l;++n)if((t=arguments[n])instanceof Object)for(r in t)c.call(t,r)&&(e[r]=t[r])}(f,r)}();var v={html:"http://www.w3.org/1999/xhtml",math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},r=/-([a-z])?/g,l=function(e,t){return t?t.toUpperCase():""},o={};function m(e){if(e.indexOf("-")<0)return e;if(e in o)return o[e];var t=e.replace(r,l);return o[e]=t}var u=/\s+/;function i(e){if(e){var t=typeof e;if("string"===t)return e.trim().split(u);if("object"===t){var r=[];for(var n in e)e[n]&&r.push(n);return r}}}function a(e){var t=e.tagName;return t?t.toLowerCase():""}function s(e){return 1!==e.nodeType?"":function(e){{if(!e||e===v.html)return"";if(e===v.svg)return"svg";if(e===v.math)return"math";if(e===v.xlink)return"xlink"}return null}(e.namespaceURI||e.getAttribute("xmlns"))}function g(e){return e&&e.__extag_shell__}function d(e,t){t?e.__extag_shell__=t:delete e.__extag_shell__}var _={},P=!1;try{var e=Object.defineProperty({},"passive",{get:function(){return P=!0}});window.addEventListener("test-passive",null,e)}catch(e){}function b(e){if(e){var t=typeof e;if("string"===t)return e;if(Array.isArray(e))return e.join(" ");if("object"===t){var r=[];for(var n in e)e[n]&&c.call(e,n)&&r.push(n);return r.join(" ")}}return""}function t(e,t,r){(t=b(t))!==(r=b(r))&&e.setAttribute("class",t)}f.className.render=t,f.class.render=t;var w,x=["webkit","Webkit","Moz","ms","O"];var U={float:"cssFloat"};function B(e,t){if(e in U)return U[e];var r=m(e);return r in t?U[e]=r:(r=r.charAt(0).toUpperCase()+r.slice(1),w||(w=function(e,t){for(var r=0;r<x.length;++r)if(x[r]+e in t)return x[r]}(r,t)),w&&(r=w+r)in t?U[e]=r:void 0)}function N(e,t){var r,n,l,o,u=t.$meta;return u.type===h?13===e.nodeType:!(u.tag!==a(e)||u.ns!==s(e)||(l=e,((o=t._props)&&o.id)!=l.getAttribute("id"))||!function(e,t){var r=t._classes,n=e.getAttribute("class"),l=r&&r._props;if(n&&!l)return!1;var o=i(n)||p,u=i(l)||p;return o.length===u.length&&(1===u.length?o[0]===u[0]:o.sort().join(" ")===u.sort().join(" "))}(e,t)||"input"===u.tag&&(r=e,((n=t._props)&&n.type||"text")!==(r.getAttribute("type")||"text")))||void 0}function A(e){for(var t=a(e),r=e.attributes,n=r.length-1;0<=n;--n){var l=r[n],o=l.name;if("id"!==o&&"class"!==o&&("type"!==o||"input"!==t)){var u=f[o];u&&u.mustUseProperty?u.isBoolProperty?e[o]=!1:e[o]="":l.namespaceURI?e.removeAttributeNS(l.namespaceURI,o):e.removeAttribute(o)}}}function E(e,t,r){if(t.$meta.type!==y){var n,l,o,u,i,a,s;r=function e(t,r){var n,l,o=t.length;for(r=r||[],n=0;n<o;++n)(l=t[n]).$meta.type===y?l._children&&e(l._children,r):r.push(l);return r}(r);var p,c,f,m=e.childNodes;if(l=r.length,o=m.length)for(n=o-1;0<=n;--n)(i=g(s=m[n]))&&t!==i.getParent(!0)&&e.removeChild(s);if(l){for(n=0;n<l;++n)(u=r[n]).$skin&&(u.__extag_index__=n);for(n=0;n<l;++n){if(a=(u=r[n]).$skin,i=(s=m[n])?g(s):null,!a){var d=u.$meta;s&&!i&&N(s,u)?A(a=s):(p=d.type,c=d.tag,f=d.ns,a=p===h?document.createTextNode(""):f?document.createElementNS(v[f],c):document.createElement(c)),u.attach(a)}s?a!==s&&(e.insertBefore(a,s),i&&i.__extag_index__?e.insertBefore(s,m[i.__extag_index__]||null):e.removeChild(s)):e.appendChild(a)}}}}function k(e,t){var r=b(e),n=b(t);return r?n?n+" "+r:r:n}var $={query:function(e,t){return(t||document).querySelector(e)},invoke:function(e,t){var r=e[t];return arguments.length<3?r.call(e):r.apply(e,n.call(arguments,2))},attachShell:function(e,t){var r=g(e);if(r){if(r===t)return;throw new Error("a shell can not attach a $skin that has been attached")}var n=t.$meta;if(1===n.type&&n.tag!==a(e))throw new Error("a shell can not attach a $skin that has a different tag");if(n.ns!==s(e))throw new Error("a shell can not attach a $skin that has a different namespace");d(e,t)},detachShell:function(e,t){g(e)===t&&d(e,null)},renderShell:function(e,t){if(g(e)!==t)throw new Error("the shell is not attached to this $skin");var r=t.$meta;if(r.type===h)t._dirty&&(e.nodeValue=t._content);else if(1===r.type){var n,l,o=t.$props;o?n=(l=function(e,t,r,n){if(!t)return e;if(!e)return t;var l,o={};for(l in e)o[l]=e[l];for(l in t)l in o||l in r||(o[l]=t[l]);return"class"in o&&(o.class=k(e[l],t[l])),o}(t._dirty,o._dirty,t._props,o._props))===t._dirty?t._props:l===o._dirty?o._props:function(e,t,r){if(r){var n,l={};for(n in r)l[n]=n in e?e[n]:t[n];return"class"in l&&(l.class=k(e[n],t[n])),l}}(t._props,o._props,l):(n=t._props,l=t._dirty),n&&l&&function(e,t,r){var n,l,o,u,i;for(n in r)c.call(r,n)&&(u=t[n],(l=f[n])?l.render?l.render(e,u,r[n]):l.mustUseProperty?e[l.propertyName]=u:null!=u?e.setAttribute(l.attributeName,u):e.removeAttribute(l.attributeName):(i=(o=n.indexOf(":"))<=0?null:v[n.slice(0,o)])?(n=n.slice(o+1),null!=u?e.setAttributeNS(i,n,u):e.removeAttributeNS(i,n)):(o<=0||"x"!==n.slice(0,o))&&(null!=u?e.setAttribute(n,u):e.removeAttribute(n)))}(e,n,l);var u=n&&n.shadowMode,i=t._children,a=t._style,s=t.$style;l=a&&s?(n=function(e,t){var r,n,l=e._props,o=e._dirty,u=t._props,i=t._dirty,a={};if(o)for(r in o)a[n="-"!==r[0]||"-"!==r[1]?m(r):r]=l[r];if(i)for(r in i)(n="-"!==r[0]||"-"!==r[1]?m(r):r)in a||r in l||n in l||(a[n]=u[r]);return a}(a,s))===a._props?a._dirty:n===s._props?s._dirty:n:a?(n=a._props,a._dirty):s?(n=s._props,s._dirty):n=null,n&&l&&function(e,t,r){var n,l,o=e.style;for(n in r)c.call(r,n)&&("-"!==n[0]||"-"!==n[1]?(l=B(n,o))&&(o[l]=t[n]):null!=t[n]?o.setProperty(n,t[n]):o.removeProperty(n))}(e,n,l),i&&2&t.$flag&&(u&&e.attachShadow?(null==e.shadowRoot&&e.attachShadow({mode:u}),E(e.shadowRoot,t,i)):E(e,t,i)),t._commands&&8&t.$flag&&function(e,t){for(var r=0,n=t.length;r<n;++r){var l=t[r];if(l&&l.name){var o=e[l.name];"function"==typeof o&&o.apply(e,l.args||p)}}}(e,t._commands)}},getTagName:a,getNameSpace:s,hasNameSpace:function(e){return c.call(v,e)},mayDispatchEvent:function(e,t){var r=e.tagName;if(!r)return!1;var n=_[r]||{};if(t in n)return n[t];n[t]=!1,_[r]=n;var l,o="on"+t;if(o in e)if("function"==typeof e[o])n[t]=!0;else{l=e.getAttribute(o);try{e.setAttribute(o,"void 0"),"function"==typeof e[o]&&(e[o]=null,n[t]=!0)}catch(e){n[t]=!1}l?e.setAttribute(o,l):e.removeAttribute(o)}return n[t]},addEventListener:function(e,t,r,n){n?n.passive?e.addEventListener(t,r,P?n:!!n.capture):e.addEventListener(t,r,!!n.capture):e.addEventListener(t,r)},removeEventListener:function(e,t,r,n){e.removeEventListener(t,r,!!n&&!!n.capture)}};return window.Extag&&window.Extag.conf("view-engine",$),$});
