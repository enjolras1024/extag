!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ExtagDom=t()}(this,function(){"use strict";var s=Object.prototype.hasOwnProperty;function n(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");var t,r,l,n=arguments.length;for(l=1;l<n;++l)if((t=arguments[l])instanceof Object)for(r in t)s.call(t,r)&&Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));return e}var o=!1;try{var e=Object.defineProperty({},"passive",{get:function(){return o=!0}});window.addEventListener("test-passive",null,e)}catch(e){}var a={},i={accept:null,acceptCharset:{attributeName:"accept-chartset"},accessKey:null,action:null,allowFullscreen:{isBoolProperty:!0,mustUseProperty:!0},allowTransparency:null,alt:null,async:{isBoolProperty:!0,mustUseProperty:!0},autocomplete:null,autofocus:{isBoolProperty:!0},autoplay:{isBoolProperty:!0},capture:{isBoolProperty:!0,mustUseProperty:!0},cellPadding:null,cellSpacing:null,charset:null,challenge:null,checked:{isBoolProperty:!0,mustUseProperty:!0},cite:null,classid:null,className:{attributeName:"class"},cols:null,colSpan:null,content:null,contentEditable:null,contextMenu:null,controls:{isBoolProperty:!0,mustUseProperty:!0},coords:null,crossOrigin:null,data:{mustUseProperty:!0},dateTime:null,default:{isBoolProperty:!0,mustUseProperty:!0},defer:{isBoolProperty:!0,mustUseProperty:!0},dir:null,disabled:{isBoolProperty:!0,mustUseProperty:!0},download:null,draggable:null,enctype:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:{isBoolProperty:!0,mustUseProperty:!0},formTarget:null,frameBorder:null,headers:null,height:null,hidden:{isBoolProperty:!0,mustUseProperty:!0},high:null,href:null,hreflang:null,htmlFor:{attributeName:"for"},httpEquiv:null,icon:null,id:null,innerHTML:{attributeName:"inner-html",mustUseProperty:!0},inputMode:null,integrity:null,is:null,keyparams:null,keytype:null,kind:null,label:null,lang:null,list:null,loop:{isBoolProperty:!0,mustUseProperty:!0},low:null,manifest:null,marginHeight:null,marginWidth:null,max:null,maxLength:null,media:null,mediaGroup:null,method:null,min:null,minLength:null,multiple:{isBoolProperty:!0,mustUseProperty:!0},muted:{isBoolProperty:!0,mustUseProperty:!0},name:null,nonce:null,noValidate:{isBoolProperty:!0,mustUseProperty:!0},open:{isBoolProperty:!0,mustUseProperty:!0},optimum:null,pattern:null,placeholder:null,poster:null,preload:null,profile:null,radiogroup:null,readOnly:{isBoolProperty:!0,mustUseProperty:!0},referrerPolicy:null,rel:null,required:{isBoolProperty:!0,mustUseProperty:!0},reversed:{isBoolProperty:!0,mustUseProperty:!0},role:null,rows:null,rowSpan:null,sandbox:null,scope:null,scoped:{isBoolProperty:!0,mustUseProperty:!0},scrolling:null,seamless:{isBoolProperty:!0,mustUseProperty:!0},selected:{isBoolProperty:!0,mustUseProperty:!0},shape:null,size:null,sizes:null,span:null,spellcheck:null,src:null,srcdoc:null,srclang:null,srcset:null,start:null,step:null,style:null,summary:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:{mustUseProperty:!0},width:null,wmode:null,wrap:null,about:null,datatype:null,inlist:null,prefix:null,property:null,resource:null,typeof:null,vocab:null,autocapitalize:null,autocorrect:null,autosave:null,color:null,itemprop:null,itemscope:{isBoolProperty:!0,mustUseProperty:!0},itemtype:null,itemid:null,itemref:null,results:null,security:null,unselectable:null},u=function(e){var t,r,l={};for(t in e)(r=e[t])&&r.attributeName?l[t]=r.attributeName:l[t]=t.toLowerCase();return l}(i);u.cssFloat="float";var c,p=function(e){var t,r={};for(t in e)s.call(e,t)&&(r[e[t]]=t);return r}(u),f={html:"http://www.w3.org/1999/xhtml",math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},l=["webkit","Webkit","Moz","ms","O"];function m(e,t){for(var r=0;r<l.length;++r)if(l[r]+t in e)return l[r]}var r=window.document,t=/-([a-z])?/g,d=/([A-Z])/g,h=function(e,t){return t?t.toUpperCase():""},y=function(e,t){return"-"+t.toLowerCase()};function g(e){return e in u?u[e]:d.test(e)?e.replace(d,y):e}function v(e,t){var r,l,n=e.length;for(t=t||[],r=0;r<n;++r)0===(l=e[r]).$type?l._children&&v(l._children,t):t.push(l);return t}function P(e,t){if(t){var r,l={};for(r in n(l,e),t)null==l[r]&&(l[r]=t[r]);return l}return e}function _(e,t){return t?n({},t,e):e}var w=Array.prototype.slice;function b(){var e=arguments[0];if(e&&this[e])return this[e].apply(this,w.call(arguments,1))}return n(b,{version:"0.2.3",toCamelCase:function(e){return e in p?p[e]:e.indexOf("-")<0?e:e.replace(t,h)},toKebabCase:g,isBoolProp:function(e){var t=i[e];return t&&t.isBoolProperty},isText:function(e){return!!e&&3===e.nodeType},isComment:function(e){return!!e&&8===e.nodeType},isElement:function(e){return!!e&&1===e.nodeType},createText:function(e){return r.createTextNode(e)},createElement:function(e,t){return e?r.createElementNS(f[e],t):r.createElement(t)},createFragment:function(){return r.createDocumentFragment()},getTagName:function(e){var t=e.tagName;return t?t.toLowerCase():""},getNameSpace:function(e){if(b.isElement(e)){var t=e.namespaceURI||e.getAttribute("xmlns");return b.toNameSpace(t)}return""},hasNameSpace:function(e){return s.call(f,e)},toNameSpace:function(e){return e&&e!==f.html?e===f.svg?"svg":e===f.math?"math":e===f.xlink?"xlink":null:""},toTemplate:function(e){if(!b.isElement(e))return null;var t={};t.ns=b.getNameSpace(e),t.tagName=b.getTagName(e);var r=b.getAttrs(e);r&&(t.attributes=r);var l,n,o,a=b.getChildren(e);if(a.length)for(t.children=[],l=0,n=a.length;l<n;++l)o=a[l],b.isText(o)?t.children.push(b.getProp(o,"data")):b.isElement(o)?t.children.push(b.toTemplate(o,e)):b.isComment(o)&&t.children.push({ns:"",tagName:"!",comment:b.getProp(o,"data")});return t},toOuterHTML:function(e){return e.outerHTML},getAttrs:function(e){if(b.isElement(e)&&e.hasAttributes()){for(var t,r,l,n={},o=e.attributes,a=0,u=o.length;a<u;++a)r=(t=o[a]).namespaceURI?b.toNameSpace(t.namespaceURI)+":"+t.name:t.name,s.call(p,r)&&(l=i[p[r]])&&l.isBoolProperty?n[r]="true":n[r]=t.value;return n}},hasProp:function(e,t){return t in e},getProp:function(e,t){return e[t]},getChildren:function(e){var t=[],r=e.childNodes;return r&&r.length&&t.push.apply(t,r),t},getParent:function(e){return e.parentNode},getShell:function(e){return e&&e.__extag_shell__},setShell:function(e,t){t?Object.defineProperty(e,"__extag_shell__",{value:t,writable:!0,enumerable:!1,configurable:!0}):delete e.__extag_shell__},attachShell:function(e,t){var r=b.getShell(e);if(r){if(r===t)return;throw new Error("a shell can not attach a $skin that has been attached")}if(1===t.$type&&t.tag!==b.getTagName(e))throw new Error("a shell can not attach a $skin that has a different tag");if(t.ns!==b.getNameSpace(e))throw new Error("a shell can not attach a $skin that has a different namespace");b.setShell(e,t)},detachShell:function(e,t){b.getShell(e)===t&&b.setShell(e,null)},query:function(e,t){return(t||r).querySelector(e)},invoke:function(e,t,r){e[t].apply(e,r)},mayDispatchEvent:function(e,t){var r=e.tagName;if(!r)return!1;var l=a[r]||{};if(t in l)return l[t];a[r]=l;var n,o="on"+t;if(o in e){if("function"==typeof e[o])return!0;n=e.getAttribute(o);try{e.setAttribute(o,"return;"),"function"==typeof e[o]?(e[o]=null,l[t]=!0):l[t]=!1}catch(e){l[t]=!1}n?e.setAttribute(o,n):e.removeAttribute(o)}else l[t]=!1;return l[t]},addEventListener:function(e,t,r,l){l?e.addEventListener(t,r,o?l:!!l.capture):e.addEventListener(t,r,!1)},removeEventListener:function(e,t,r,l){e.removeEventListener(t,r,!!l&&!!l.capture)},renderShell:function(e,t){if(b.getShell(e)!==t)throw new Error("the shell is not attached to this $skin");var r,l;if(r=t._props,l=t._dirty,t.__props&&(r=P(r,t.__props._props),l=_(l,t.__props._dirty)),r&&l&&b.renderProps(e,r,l),t.tag){var n,o=r.shadowMode,a=t._attrs,u=t._style,s=t._classes,i=t._children;if(1===t.$type&&(l=a?(r=a._props,a._dirty):r=null,t.__attrs&&(r=P(r,t.__attrs&&t.__attrs._props),l=_(l,t.__attrs&&t.__attrs._dirty)),r&&l&&b.renderAttrs(e,r,l),l=u?(r=u._props,u._dirty):r=null,t.__style&&(r=P(r,t.__style._props),l=_(l,t.__style._dirty)),r&&l&&b.renderStyle(e,r,l),l=s?(r=s._props,s._dirty):r=null,t.__classes&&(r=P(r,t.__classes._props),l=_(l,t.__classes._dirty)),r&&l&&b.renderClasses(e,r,l)),i&&2&t.$flag)if((n=o&&e.attachShadow?(null==e.shadowRoot&&e.attachShadow({mode:o}),b.renderChildren(e.shadowRoot,t,v(i))):b.renderChildren(e,t,v(i)))&&n.length)for(var c=0,p=n.length;c<p;++c){var f=b.getParent(n[c]),m=b.getShell(n[c]);!f&&m&&m.detach()}t._commands&&b.invokeCommands(e,t._commands)}},renderAttrs:function(e,t,r){var l,n,o,a;for(l in r)s.call(r,l)&&(n=t[l],0<(o=l.indexOf(":"))&&(a=f[l.slice(0,o)]),a?(l=l.slice(o+1),null!=n?e.setAttributeNS(a,l,n):e.removeAttributeNS(a,l)):null!=n?e.setAttribute(l,n):e.removeAttribute(l))},renderProps:function(e,t,r){var l,n,o;for(l in r)s.call(r,l)&&(n=i[l],o=t[l],n?n.mustUseProperty?e[l]=o:null!=o?e.setAttribute(u[l],o):e.removeAttribute(u[l]):null!=o?e.setAttribute(g(l),o):e.removeAttribute(g(l)))},renderStyle:function(e,t,r){var l,n=e.style;for(l in r)if(s.call(r,l))if(l in n)n[l]=t[l];else if("--"===l.slice(0,2))n.setProperty(l,t[l]);else{var o=l.charAt(0).toUpperCase()+l.slice(1);c||(c=m(n,o)),c&&(n[c+o]=t[l])}},renderClasses:function(e,t,r){var l,n=e.classList;if(n)for(l in r)s.call(r,l)&&(t[l]?n.add(l):n.remove(l));else{var o=[];for(l in t)s.call(t,l)&&t[l]&&o.push(l);e.setAttribute("class",o.join(" "))}},invokeCommands:function(e,t){for(var r=0,l=t.length;r<l;++r){var n=t[r];b.invoke(e,n.name,n.args)}},renderChildren:function(e,t,r){if(0!==t.$type){var l,n,o,a,u,s,i,c,p=e.childNodes;if(n=r.length)for(l=0;l<n;++l){if(s=(a=r[l]).$skin,i=p[l],!s){var f,m=a.ns,d=a.tag,h=a.$type;s=!i||d!==b.getTagName(i)||m!==b.getNameSpace(i)||(f=i?b.getShell(i):null)&&f!==a?1===h?b.createElement(m,d,a._props&&a._props.type):b.createText(""):i,a.attach(s)}i?s!==i&&e.insertBefore(s,i):e.appendChild(s)}if(n<(o=p.length))for(c=[],l=o-1;n<=l;--l)u=p[l],c.push(u),e.removeChild(u);return c}}}),"undefined"!=typeof Extag&&Extag.conf("view-engine",b),b});
