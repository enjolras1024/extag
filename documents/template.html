<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
  <link href="../stylesheets/codemirror.css" rel="stylesheet">
  <link href="../stylesheets/alicestyle.css" rel="stylesheet">
  <link href="../stylesheets/common.css" rel="stylesheet">

  <title>模板语法 - Extag</title>
</head>
<body>
  <div class="main">
    <aside class="side-bar"></aside>
    <article class="article">
      <h2>模板语法</h2>
      <p>在定义一个子组件类时，我们可以为其声明模板。模板中可添加事件处理器、数据绑定，访问外部资源和引用其他子组件。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">SubComp</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>: <span class="cm-string">'&lt;div&gt;...&lt;/div&gt;'</span>, <span class="cm-comment">// DOM元素或字符串，且只有一个根元素</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">resources</span>: {<span class="cm-meta">...</span>},           <span class="cm-comment">// resources中添加子组件类等资源</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">attributes</span>: {<span class="cm-meta">...</span>},          <span class="cm-comment">// attributes中添加特性描述符</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre></div></div></div>
      <p>模板中除了可以访问组件本身的<span class="expr">attributes</span>和方法外，还可以访问本地静态<span class="expr">resources</span>中注册的资源，包括其他子组件类、预定义的常量和方法。</p>
      <p>在创建这个子组件类的第一个实例时，模板将会被解析，之后就可用于该子组件所有实例的初始化，自动创建根元素和后代节点，自动监听事件等等。</p>
      <h3 id="event-listening">事件监听</h3>
      <p>在模板中，我们在click等事件后面使用<span class="expr">+=</span>来表示添加一个事件处理器，看起来有点像运算符重载。可以将一个函数作为事件处理器：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">click+</span>=<span class="cm-string">"onClick"</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"Ticker"</span> <span class="cm-attribute">tick+</span>=<span class="cm-string">"onTick"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p>对于鼠标、键盘事件和属性更改通知，还可以指定事件的<a href="./event.html#event-type-and-event-extension" class="link">扩展名</a>：</p>
      <!-- <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">keyup.enter+</span>=<span class="cm-string">"onEnter"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"Timer"</span> <span class="cm-attribute">changed.time+</span>=<span class="cm-string">"onChangedTime"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">click.right+</span>=<span class="cm-string">"onClickRight"</span><span class="cm-tag cm-bracket">&gt;</span>event.button 0:left, 1:middle, 2:right<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div> -->
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">keyup.enter+</span>=<span class="cm-string">"onEnter"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"Timer"</span> <span class="cm-attribute">changed.time+</span>=<span class="cm-string">"onChangedTime"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p></p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">onEnter</span>(<span class="cm-def">event</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">// DOM事件的处理函数，接受的参数是DOM事件。</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">onChangedTime</span>(<span class="cm-def">name</span>, <span class="cm-def">value</span>, <span class="cm-def">target</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">// 属性更改事件的处理函数，接受的参数依次为属性名、属性值和目标组件。</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div></div></div>
      <p>实际上就是使用<span class="expr">on</span>方法来监听事件，而组件、元素销毁之时则自动调用<span class="expr">off</span>移除所有的事件处理器。</p>
      <p>你很可能需要在组件<span class="expr">setup</span>的时候，手动地将一个函数绑定到<span class="expr">this</span>，像这样：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// setup发生在模板引擎开始工作之前</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">setup</span>() { </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">this</span>.<span class="cm-property">onClick</span> <span class="cm-operator">=</span> <span class="cm-keyword">this</span>.<span class="cm-property">onClick</span>.<span class="cm-property">bind</span>(<span class="cm-keyword">this</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div></div></div>
      <p>或者在模板表达式中使用<span class="expr">::bind</span>加以修饰，Extag自动帮你将组件<span class="expr">prototype</span>上已有的一个函数绑定到<span class="expr">this</span>，像这样：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">click+</span>=<span class="cm-string">"onClick::bind"</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p>如果无需处理事件参数，则可以使用一小段JS表达式作为内联的事件处理器：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">click+</span>=<span class="cm-string">"close()"</span><span class="cm-tag cm-bracket">&gt;</span>Close<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <!-- <div class="tip-box"><p>这里，<span class="expr">this.</span>是必需的。如果想省略<span class="expr">this.</span>，仍然需要在<span class="expr">setup</span>时手动将这个<span class="expr">组件prototype</span>上已有的函数绑定到<span class="expr">this</span>。这条规则同样适用于后面的数据绑定表达式。</p></div> -->
      <!-- <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">click+</span>=<span class="cm-string">"this.count += 1;"</span><span class="cm-tag cm-bracket">&gt;</span>Close<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">change+</span>=<span class="cm-string">"onChange(event)"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div> -->
      <!-- <p>这时，Extag会帮你把内联的事件处理器绑定到<span class="expr">this</span>。</p> -->
      <p>你还可以在表达式后面追加其他一些修饰器，以双冒号<span class="expr">::</span>来连接：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">click+</span>=<span class="cm-string">"close()::once::stop::prevent::capture"</span><span class="cm-tag cm-bracket">&gt;</span>Close<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p><span class="expr">once</span>表示单次监听，<span class="expr">stop</span>的作用是<span class="expr">event.stopPropagation()</span>，<span class="expr">prevent</span>的作用是<span class="expr">event.preventDefault()</span>，<span class="expr">capture</span>表示监听捕获阶段的事件。</p>
      <h3 id="data-binding">数据绑定</h3>
      <p>Extag中的数据绑定是基于自定义属性更改事件而实现的。这意味着，即便不使用绑定，你也能完成数据的传递。很显然，在模板中使用数据绑定表达式更为简洁直观。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">value@</span>=<span class="cm-string">"message"</span> <span class="cm-attribute">x:name</span>=<span class="cm-string">"msg"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p>几乎等价于：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">this</span>.<span class="cm-property">on</span>(<span class="cm-string">'changed.message'</span>, (<span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">this</span>.<span class="cm-property">msg</span>.<span class="cm-property">set</span>(<span class="cm-string">'value'</span>, <span class="cm-keyword">this</span>.<span class="cm-property">message</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}).<span class="cm-property">bind</span>(<span class="cm-keyword">this</span>));</span></pre></div></div></div>
      <p>我们使用<span class="expr">@</span>符号表示等号后面是一个绑定表达式。表达式中可以只是一个特性名，也可以是一小段JS，可以包括多个属性名或属性路径。元素或组件属性绑定的语法，使用<span class="expr">@=</span>来连接对象属性和绑定表达式，看起来就像是运算符重载：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--&lt;对象属性名&gt;@="&lt;求值器表达式&gt;[|=转换器表达式][绑定模式符]"--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单向绑定--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">class@</span>=<span class="cm-string">"className"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单次绑定，以?结尾--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span> <span class="cm-attribute">style@</span>=<span class="cm-string">"styleString ?"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单次赋值，以!结尾--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src@</span>=<span class="cm-string">"imgSrc !"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单向绑定，连无参转换器--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">title@</span>=<span class="cm-string">"title |=upper"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单向绑定，连带参转换器--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">value@</span>=<span class="cm-string">"date |=format('yyyy-MM-dd')"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单向绑定，简单的JS表达式--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">class@</span>=<span class="cm-string">"active ? 'active' : ''"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--多路单向绑定，当text、limit属性值改变后都会执行--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">inner-html@</span>=<span class="cm-string">"encode(ellipsis(text, limit))"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--以^结尾，表示到了update阶段，无论如何都会执行一次--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">inner-html@</span>=<span class="cm-string">"getCurrentTime() ^"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <div class="tip-box"><p>以<span class="expr">?</span>结尾的单次绑定是指赋完初始值后，还会监听一次该表达式中某个可绑定属性的更改，表达式还有可能再次执行，然后解除绑定。而以<span class="expr">!</span>结尾的表达式只会执行一次，不会监听属性更改事件。</p></div>
      <!-- <div class="tip-box"><p>过长的表达式可以通过依赖属性来替代，或者使用内联的绑定域事件来触发一个get函数。复杂的get函数可以@updated，因为组件失效后，总会在render之前触发updated事件。</p></div> -->
      <!-- <p>对于string、number和boolean类型属性的字面量赋值，不必使用数据绑定：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"range"</span> <span class="cm-attribute">min</span>=<span class="cm-string">"0"</span> <span class="cm-attribute">max</span>=<span class="cm-string">"100"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"checkbox"</span> <span class="cm-attribute">checked</span> <span class="cm-attribute">value</span>=<span class="cm-string">"1"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"Button"</span> <span class="cm-attribute">disabled</span>=<span class="cm-string">"true"</span><span class="cm-tag cm-bracket">&gt;</span>Submit<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p></p>
      <p>对于<a class="link" href="#using-child-component">子组件</a>的Array和Object类型属性的字面量赋值，数据绑定还是必需的：</p> -->
      <p>对于<a class="link" href="#using-child-component">子组件</a>的number、boolean、Object类型特性的字面量赋值，数据绑定也是必需的：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"checkbox"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"1"</span> <span class="cm-attribute">checked</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"Button"</span> <span class="cm-attribute">disabled@</span>=<span class="cm-string">"true"</span><span class="cm-tag cm-bracket">&gt;</span>Submit<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"Slider"</span> <span class="cm-attribute">min@</span>=<span class="cm-string">"0"</span> <span class="cm-attribute">max@</span>=<span class="cm-string">"100"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"MapBox"</span> <span class="cm-attribute">map@</span>=<span class="cm-string">"{a:1,b:2,c:3}"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"ListBox"</span> <span class="cm-attribute">list@</span>=<span class="cm-string">"[1,2,3,4,5]"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div>
      <p>这种情况下，数据绑定只会完成一次字面量赋值，没有什么需要监听的属性更改事件，也不必以<span class="expr">!</span>结尾。子组件boolean类型属性的常量赋值必须使用<span class="expr">@=</span>，指明是<span class="expr">true</span>或<span class="expr">false</span>，而原生boolean类型的DOM属性(checked等)，只要出现在标签中就被认为是<span class="expr">true</span>，不必使用<span class="expr">@=</span>。</p>
      <h3 id="two-way-data-binding">双向数据绑定</h3>
      <p>在模板中，组件与组件、组件与<a href="./model.html#store-for-object" class="link">Store</a>对象之间可以使用双向数据绑定。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--&lt;对象属性名&gt;@="&lt;双向绑定符@&gt;&lt;属性路径&gt;"--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--组件与组件之间的双向数据绑定--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"TextInput"</span> <span class="cm-attribute">model@</span>=<span class="cm-string">"@text"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--组件与Store对象之间的双向数据绑定--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"TextInput"</span> <span class="cm-attribute">model@</span>=<span class="cm-string">"@store.text"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p>其中TextInput是对input[type=text]封装而成的组件，model是可绑定的。参见<a class="link" href="#using-child-component">使用子组件</a>。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">TextIput</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">attributes</span>: [<span class="cm-string">'model'</span>],</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">template</span>: <span class="cm-string">'&lt;input type="text" value@="model" change+="onChange::bind"&gt;'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">onChange</span>: <span class="cm-keyword">function</span>(<span class="cm-def">event</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">this</span>.<span class="cm-property">model</span> <span class="cm-operator">=</span> <span class="cm-variable-2">event</span>.<span class="cm-property">target</span>.<span class="cm-property">value</span>;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre></div></div></div>
      <div class="tip-box"><p>如果绑定对象不是组件，而是元素，或者绑定的对象属性是不可绑定的，则双向绑定只能单向有用。反之，如果绑定源或绑定源属性是不可绑定的，则双向绑定也只能单向有用。</p></div>
      <h3 id="fragment-binding">片段插值绑定</h3>
      <p>上文中使用了<span class="expr">inner-html</span>，是Extag为元素特殊定义的特性，对应属性innerHTML。对于innerText或textContent，Extag则没有提供对应的特性，这时你可以在模板中使用片段插值绑定。模板中的片段插值绑定，由静态文本和以<span class="expr">@{ }</span>包裹的数据绑定表达式共同组成。基本语法如下：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--@{&lt;求值器表达式&gt;[|=转换器表达式][绑定模式符]}--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单向绑定--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span>@{address}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单次绑定，以?结尾--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Tips: @{tips ?}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单次赋值，以!结尾--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span>@{label !}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单向绑定，连无参转换器--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">h1</span><span class="cm-tag cm-bracket">&gt;</span>@{title |=upper}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">h1</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单向绑定，连有参转换器--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>@{date |=format('yyyy-MM-dd')}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--单路单向绑定，简单的JS表达式--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>Anwser: @{choice === 1 ? 'yes' : 'no'}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--多路单向绑定，JS表达式，当text、limit属性值改变后都会执行--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>@{text.slice(0, limit}...<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--以^结尾，表示到了update阶段，无论如何都会执行一次--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>@{getCurrentTime() ^}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p><span class="expr">@{ }</span>一般返回的是文本内容，偶尔也可用来返回一个虚拟节点或数组，作用类似于JSX，参见<a class="link" href="#fragment-rendering">片段渲染</a>。</p>
      <p>片段插值绑定同样可用于元素或组件属性，使用#=来连接对象属性和片段插值绑定表达式：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--&lt;对象属性名&gt;#="穿插一个或多个@{&lt;求值器表达式&gt;[|=转换器表达式][绑定模式符]}"--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href#</span>=<span class="cm-string">"https://www.xxx.com/@{module}/@{page}.html"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">   <span class="cm-attribute">class#</span>=<span class="cm-string">"btn btn-next @{page &gt;= total ? 'disabled' : ''}"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">   <span class="cm-attribute">style#</span>=<span class="cm-string">"margin: 5px; color: @{color}; font-size: @{fontSize}px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  下一页</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <h3 id="class-and-style-binding">class和style绑定</h3>
      <p>特别地，对于class和style的绑定，除了使用<span class="expr">@=</span>，<span class="expr">#=</span>外，Extag还提供了一种更优化的扩展语法，通过特性<span class="expr">x:class</span>和<span class="expr">x:style</span>来实现：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--&lt;静态类名&gt;; &lt;动态类名&gt;:@{&lt;求值器表达式&gt;[|=转换器表达式][绑定模式符]};--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">x:class</span>=<span class="cm-string">"btn btn-next; disabled: @{page &gt;= total};"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">   <span class="cm-attribute">x:style</span>=<span class="cm-string">"margin: 5px; color: @{color}; font-size: @{fontSize}px;"</span><span class="cm-tag cm-bracket">&gt;</span>下一页<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span>  </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--&lt;样式属性名&gt;:可穿插多个@{&lt;求值器表达式&gt;[|=转换器表达式][绑定模式符]};--&gt;</span></span></pre></div></div></div>
      <div class="tip-box">
        <p>注意这里有一个限制，由于我们使用分号<span class="expr">;</span>来分割多个表达式，因此各个表达式中不能再出现分号<span class="expr">;</span>。而通常来说，这不成问题。</p>
      </div>
      <p>模板中的<span class="expr">x:class</span>和<span class="expr">x:style</span>即对应着元素和组件的成员对象classes和style。<span class="expr">x:class</span>中静态class名可以直接列出来，如<span class="expr">btn btn-next;</span>。而动态class名，由<span class="expr">@{ }</span>表达式返回boolean类型的值，来决定保留与否。<span class="expr">x:style</span>中的样式属性值都为string类型，可插入必要的<span class="expr">@{ }</span>表达式。</p>
      <p>注意，最好不要在同一个标签上同时使用，<span class="expr">class@=</span>，<span class="expr">class#=</span>和<span class="expr">x:class=</span>，以及<span class="expr">style@=</span>，<span class="expr">style#=</span>和<span class="expr">x:style=</span>，因为容易发生冲突。</p>
      <!-- <p>x:class和x:style可以配合一般的class、style一起使用，模板编译时会将class和style中的常量分别合并到x:class和x:style中。例如：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">class</span>=<span class="cm-string">"btn-next"</span> <span class="cm-attribute">x:class</span>=<span class="cm-string">"disabled@: page &gt;= total;"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">   <span class="cm-attribute">style</span>=<span class="cm-string">"color: black;"</span> <span class="cm-attribute">x:style</span>=<span class="cm-string">"font-size#: @{ fontSize }px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  下一页</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span> </span></pre></div></div></div> -->
      <!-- <p>带绑定的class和<span class="expr">x:class</span>，带绑定的style和<span class="expr">x:style</span>，最好不要放在一起使用，因为容易发生冲突。例如：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">class@</span>=<span class="cm-string">"classObject"</span> <span class="cm-attribute">x:class</span>=<span class="cm-string">"disabled@: page &gt;= total;"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">   <span class="cm-attribute">style@</span>=<span class="cm-string">"styleObject"</span> <span class="cm-attribute">x:style</span>=<span class="cm-string">"font-size#: @{ fontSize }px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  下一页</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span> </span></pre></div></div></div>
      <p>组件的styleObject和fontSize这两个变量都会影响到font-size。styleObject没有fontSize属性，则表示font-size置空。Extag不知道如何解决这种冲突。</p> -->
      <!-- <h3 id="store-for-object">Store for Object</h3>
      <p>如果没有特殊要求，你可以直接使用普通的Object来为组件提供数据。如果需要观察数据对象内部属性的变化，能够在组件模板中形成绑定关系，则可以使用Extag提供的Store。在构造Store实例时，提供一些初始属性值给Store的构造函数，即可为这个实例创建相应的getter/setter。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">point</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Extag</span>.<span class="cm-property">Store</span>({<span class="cm-property">x</span>:<span class="cm-number">0</span>, <span class="cm-property">y</span>: <span class="cm-number">0</span>, <span class="cm-property">z</span>:<span class="cm-number">0</span>});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">on</span>(<span class="cm-string">'changed'</span>, <span class="cm-keyword">function</span>(<span class="cm-def">key</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">'changed.'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">key</span>, <span class="cm-variable">point</span>[<span class="cm-variable-2">key</span>]);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">x</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>;<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">// 输出：changed.x 1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">y</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>;<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">// 输出：changed.y 2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">z</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>;<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">// 输出：changed.z 3</span></span></pre></div></div></div>
      <p>同Component一样，Store具有良好的可扩展性，继承时支持attributes声明和验证。Store子类只在第一次实例化时，才会在子类prototype上为声明的attributes创建getter/setter。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">Point</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Store</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-property">attributes</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">          <span class="cm-property">x</span>: {<span class="cm-property">type</span>: <span class="cm-string">'number'</span>, <span class="cm-property">value</span>: <span class="cm-number">0</span>},</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">          <span class="cm-property">y</span>: {<span class="cm-property">type</span>: <span class="cm-string">'number'</span>, <span class="cm-property">value</span>: <span class="cm-number">0</span>},</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">          <span class="cm-property">z</span>: {<span class="cm-property">type</span>: <span class="cm-string">'number'</span>, <span class="cm-property">value</span>: <span class="cm-number">0</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">toString</span>: <span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">return</span> <span class="cm-string">'('</span> <span class="cm-operator">+</span> <span class="cm-keyword">this</span>.<span class="cm-property">x</span> <span class="cm-operator">+</span> <span class="cm-string">', '</span> <span class="cm-operator">+</span> <span class="cm-keyword">this</span>.<span class="cm-property">y</span> <span class="cm-operator">+</span> <span class="cm-string">', '</span> <span class="cm-operator">+</span> <span class="cm-keyword">this</span>.<span class="cm-property">z</span>  <span class="cm-operator">+</span> <span class="cm-string">')'</span>;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">point</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Point</span>(); <span class="cm-comment">// 在Point.prototype上为声明的attributes创建getter/setter</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">on</span>(<span class="cm-string">'changed'</span>, <span class="cm-keyword">function</span>(<span class="cm-def">key</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">'changed.'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">key</span>, <span class="cm-variable">point</span>.<span class="cm-property">toString</span>());</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">x</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>;            <span class="cm-comment">// 输出：changed.x (1, 0, 0)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">set</span>(<span class="cm-string">'y'</span>, <span class="cm-number">2</span>);      <span class="cm-comment">// 输出：changed.y (1, 2, 0)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-variable">assign</span>({<span class="cm-variable">z</span>: <span class="cm-number">3</span>});   <span class="cm-comment">// 输出：changed.z (1, 2, 3)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">point2</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Point</span>(); <span class="cm-comment">// 不用为声明的attributes二次创建getter/setter</span></span></pre></div></div></div>
      <div class="tip-box"><p>对于Array，Extag没有提供类似的包装。当数组长度变化或某些索引处的元素发生了替换时，可返回新的数组，以替换旧的数组，相关的绑定才会生效。</p></div> -->
      <h3 id="optional-converters">可选转换器</h3>
      <p>单向绑定表达式中以<span class="expr">|=</span>连接的转换器是可选的。注意，绑定表达式中<span class="expr">|=</span>的作用不同于JS中的运算符<span class="expr">|=</span>。这里，转换器就是一个函数，<span class="expr">|=</span>前面的结果值作为这个函数的第一个参数传入。我们可以在组件<span class="expr">resources</span>中或组件<span class="expr">prototype</span>上注册模板中需要使用的转换器。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"demo"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">h2</span><span class="cm-tag cm-bracket">&gt;</span>@{title |=upper|=wrap('#')}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">h2</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">div</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre></div></div></div>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">Demo</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">attributes</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-property">title</span>: <span class="cm-string">''</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">resources</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-property">upper</span>: <span class="cm-keyword">function</span>(<span class="cm-def">text</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">          <span class="cm-keyword">return</span> <span class="cm-variable-2">text</span>.<span class="cm-property">toUpperCase</span>();</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-property">wrap</span>: <span class="cm-keyword">function</span>(<span class="cm-def">text</span>, <span class="cm-def">char</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">          <span class="cm-keyword">return</span> <span class="cm-variable-2">char</span> <span class="cm-operator">+</span> <span class="cm-variable-2">text</span> <span class="cm-operator">+</span> <span class="cm-variable-2">char</span>;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">template</span>: <span class="cm-variable">ExtagDom</span>.<span class="cm-property">query</span>(<span class="cm-string">'.demo'</span>).<span class="cm-property">outerHTML</span>    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre></div></div></div>
      <p>模板中<span class="expr">title|=upper|=wrap('#')</span>等价于<span class="expr">wrap(upper(title), '#')</span>，前一种写法更清晰，能突显出表达式中title是主要因素。</p>
      <div class="tip-box">
        <!--<p>注意，ES有一个双冒号运算符的提案，而Extag模板语法中<span class="expr">::</span>的作用与之不同，效果上其实更类似于ES的另一个提案，使用<span class="expr">|></span>作为管道符。</p>-->
        <p>绑定表达式中的字符串字面量不应含有<span class="expr">|=</span>，否则会解析错误，这通常不是问题。</p>
        <p>绑定表达式中的转换器不宜超过<span class="expr">2</span>个，多个转换器通常可以合为一个。</p>
      </div>
      <h3 id="using-child-component">使用子组件</h3>
      <!-- <p>在组件模板中，使用子组件的方法很简单，只需在已有HTML标签中添加x:type特性，以引用组件resources中注册的子组件类。</p> -->
      <p>在组件模板中，引用组件<span class="expr">resources</span>中注册的子组件类，有以下几种方式：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"demo"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">Button</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">Button</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">MY.Button</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">MY.Button</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"Button"</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"MY.Button"</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">x:view</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"MY.Button"</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">x:view</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <br>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">MY</span> <span class="cm-operator">=</span> {};</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">MY</span>.<span class="cm-property">Button</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>: <span class="cm-string">'&lt;a class="my-button"&gt;&lt;x:slot&gt;&lt;/x:slot&gt;&lt;/a&gt;'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">Demo</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>: <span class="cm-variable">ExtagDom</span>.<span class="cm-property">query</span>(<span class="cm-string">'.demo'</span>).<span class="cm-property">outerHTML</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">resources</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">Button</span>: <span class="cm-variable">MY</span>.<span class="cm-property">Button</span>, <span class="cm-comment">// 注册子组件类</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">MY</span>: <span class="cm-variable">MY</span> <span class="cm-comment">// 或者注册组件所在模块</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre></div></div></div>
      <p>使用字符串模板时，标签名首字母大写的元素被推测为组件。但这不适用于从html文档提取的模板，因为html标签名忽略大小写。这时，只需在已有HTML标签中添加<span class="expr">x:type</span>特性，以引用组件<span class="expr">resources</span>中注册的子组件类。</p>
      <div class="tip-box"><p><span class="expr">x:type</span>的作用有点像input元素的type属性，不同type的input有着不同的外观和功能，组件亦是如此。如果不清楚组件的根标签是什么，则可以<span class="expr">x:view</span>来替代。</p></div>
      <!-- <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"demo"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"Button"</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"MY.Button"</span><span class="cm-tag cm-bracket">&gt;</span>Cancel<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div><p></p><div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">MY</span> <span class="cm-operator">=</span> {};</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">MY</span>.<span class="cm-property">Button</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>: <span class="cm-string">'&lt;a class="my-button"&gt;&lt;x:slot&gt;&lt;/x:slot&gt;&lt;/a&gt;'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-variable">Demo</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-variable">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-variable">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">template</span>: <span class="cm-variable">ExtagDom</span>.<span class="cm-variable">query</span>(<span class="cm-string">'.demo'</span>).<span class="cm-property">outerHTML</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">resources</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">Button</span>: <span class="cm-variable">MY</span>.<span class="cm-variable">Button</span> <span class="cm-comment">// 注册子组件类</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">MY</span>: <span class="cm-variable">MY</span> <span class="cm-comment">// 或者注册组件所在模块</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre></div></div></div>
      <p>x:type的作用有点像input元素的type属性，不同type的input有着不同的外观和功能，组件亦是如此。或者不使用x:type，你也可以将PascalCase的子组件类名转换成kebab-case的自定义标签名进行使用，效果是一样的：</p> -->
      <h3 id="part-refrence">部件引用</h3>
      <p>一般来说，模板中使用了数据绑定和事件绑定后，就很少需要手动操作子元素或子组件了。否则的话，你可以在标签中添加<span class="expr">x:name</span>特性，以便引用对应的部件。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"demo"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">x:name</span>=<span class="cm-string">"input"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">div</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre></div></div></div>
      <p>这样，在JavaScript代码中，你就可以通过<span class="expr">this.input</span>方便地访问到对应的部件，并根据需要手动地添加事件处理器等。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">onInited</span>() {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">this</span>.<span class="cm-property">input</span>.<span class="cm-property">on</span>(<span class="cm-string">'change'</span>, <span class="cm-keyword">this</span>.<span class="cm-property">onInputChange</span>.<span class="cm-property">bind</span>(<span class="cm-keyword">this</span>));</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div></div></div>
      <div class="tip-box"><p>注意，你所访问到的部件仍然是Extag的Element或Component对象，而非真实的DOM元素。如果需要的话，可以在组件<span class="expr">onAttached</span>钩子函数中，通过<span class="expr">this.input.$skin</span>访问到已经附着的DOM元素。</p></div>
      <p>Extag在使用模板对组件初始化时，遇到<span class="expr">x:name</span>就会调用域组件的<span class="expr">addNamedPart(name, part)</span>方法，默认令<span class="expr">this[name] = part</span>，你可以在继承Component时重写此方法。</p>
      <!-- <p>并且，可方便地为该部件添加CSS：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-qualifier">.demo</span> [<span class="cm-tag">x:name</span>=<span class="cm-string">"input"</span>] {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">color</span>: <span class="cm-atom">#222</span>;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div></div></div> -->
      <h3 id="list-rendering">列表渲染</h3>
      <p>在模板中，使用控制特性<span class="expr">x:for</span>完成列表渲染。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--x:for="&lt;迭代器表达式&gt; of &lt;求值器表达式&gt;[|=转换器表达式][绑定模式符]"--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">ul</span> <span class="cm-attribute">class</span>=<span class="cm-string">"menu-list"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">li</span> <span class="cm-attribute">x:for</span>=<span class="cm-string">"menu of menus"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href@</span>=<span class="cm-string">"menu.url !"</span><span class="cm-tag cm-bracket">&gt;</span>@{menu.label !}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">ul</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div><p></p><div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">MenuList</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">descriptors</span>: [<span class="cm-string">'menus'</span>],</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>: <span class="cm-variable">ExtagDom</span>.<span class="cm-property">query</span>(<span class="cm-string">'.menu-list'</span>).<span class="cm-property">outerHTML</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>.<span class="cm-property">create</span>(<span class="cm-variable">MenuList</span>, {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">menus</span>: [</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-property">label</span>: <span class="cm-string">'Examples'</span>, <span class="cm-property">url</span>: <span class="cm-string">'/examples/'</span>},</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-property">label</span>: <span class="cm-string">'Downloads'</span>, <span class="cm-property">url</span>: <span class="cm-string">'/downloads/'</span>},</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-property">label</span>: <span class="cm-string">'Documents'</span>, <span class="cm-property">url</span>: <span class="cm-string">'/documents/'</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  ]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}).<span class="cm-property">attach</span>(<span class="cm-variable">ExactSkin</span>.<span class="cm-property">query</span>(<span class="cm-string">'#menu-list'</span>).<span class="cm-property">outerHTML</span>;</span></pre></div></div></div>
      <p>控制特性<span class="expr">x:for</span>的表达式中，关键字<span class="expr">of</span>的左边为迭代器变量，右边与数据绑定表达式是完全一致的。求值器部分一般就是一个数组或类数组对象，可以使用转换器对求值器求出的结果进行再加工，返回一个新的数组。例如，渲染时还需要一个索引值，</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">ul</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">li</span> <span class="cm-attribute">x:for</span>=<span class="cm-string">"entry of values|=entryList"</span> <span class="cm-attribute">x:key</span>=<span class="cm-string">"entry.value"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>@{entry.index !}. @{entry.value !}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">ul</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <br>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">entryList</span>(<span class="cm-def">values</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable-2">values</span>.<span class="cm-property">map</span>(<span class="cm-keyword">function</span>(<span class="cm-def">value</span>, <span class="cm-def">index</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">return</span> {<span class="cm-property">value</span>: <span class="cm-variable-2">value</span>, <span class="cm-property">index</span>: <span class="cm-variable-2">index</span>};</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  });</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div></div></div>
      <div class="tip-box"><p>为了不浪费之前已经渲染过的条目，指定一个与迭代器变量关联的<span class="expr">x:key</span>可以复用已有的元素。</p></div>
      <h3 id="condition-rendering">条件渲染</h3>
      <p>在模板中，使用<span class="expr">x:if</span>指令完成条件渲染。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--x:if="&lt;求值器表达式&gt;[|=转换器表达式][绑定模式符]"--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"button-bar"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">x:if</span>=<span class="cm-string">"canCancel"</span><span class="cm-tag cm-bracket">&gt;</span>Cancel<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p>当<span class="expr">canCancel</span>为<span class="expr">true</span>时才会添加Cancel按钮，为<span class="expr">false</span>又会删除它。如果只想显示或隐藏这个按钮，可以这样：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"button-bar"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">x:style</span>=<span class="cm-string">"display@: canCancel ? 'inline-block' : 'none';"</span><span class="cm-tag cm-bracket">&gt;</span>Cancel<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p>如果希望一个组件或者一大块元素，一旦条件满足而渲染出来后，不再移除它，但又要隐藏它，则可以这样：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  ...</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">&lt;!--x:if表达式以?结尾，即单次绑定--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">x:if</span>=<span class="cm-string">"showPartB ?"</span> <span class="cm-attribute">x:style</span>=<span class="cm-string">"display@: showPartB ? 'block' : 'none';"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    ...</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  ...</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p><span class="expr">x:if</span>可以配合<span class="expr">x:for</span>命令一起使用，提供更多的可能：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">ul</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">li</span> <span class="cm-attribute">x:if</span>=<span class="cm-string">"items != null"</span> <span class="cm-attribute">x:for</span>=<span class="cm-string">"item of items"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">x:if</span>=<span class="cm-string">"item.type === 'image'"</span> <span class="cm-attribute">src@</span>=<span class="cm-string">"item.image"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">x:if</span>=<span class="cm-string">"item.type === 'text'"</span><span class="cm-tag cm-bracket">&gt;</span>@{ item.text }<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">li</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">ul</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre></div></div></div>
      <div class="tip-box"><p>注意，上面的模板中，li标签上的<span class="expr">x:if</span>命令优先于<span class="expr">x:for</span>执行，因而无法访问到<span class="expr">item</span>。如果希望选择性地渲染<span class="expr">items</span>中的内容，请在<span class="expr">x:for</span>指令中添加必要的转换器进行过滤。</p></div>
      <h3 id="fragment-rendering">片段渲染</h3>
      <p>通常，<span class="expr">@{ }</span>用来返回一段文本。偶尔，你可以使用<span class="expr">@{ }</span>返回一个虚拟节点或数组，把复杂的控制逻辑隐藏在<span class="expr">@{ }</span>中，作用类似于JSX。Extag将按片段的方式来渲染虚拟节点或数组，及其前后关联的静态文本内容。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span>Please Select: @{ renderSelect(options) }<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <br>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">renderSelect</span>(<span class="cm-def">options</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable">Extag</span>.<span class="cm-property">node</span>(<span class="cm-string">'select'</span>, <span class="cm-atom">null</span>, <span class="cm-variable-2">options</span>.<span class="cm-property">map</span>(<span class="cm-keyword">function</span>(<span class="cm-def">option</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">return</span> <span class="cm-variable">Extag</span>.<span class="cm-property">node</span>(<span class="cm-string">'option'</span>, {<span class="cm-property">value</span>: <span class="cm-variable-2">option</span>.<span class="cm-property">value</span>}, [<span class="cm-variable-2">option</span>.<span class="cm-property">label</span>]);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }));</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//...</span></span></pre></div></div></div>
      <p><span class="expr">Extag.node</span>方法返回的是一个虚拟节点，方法的第一个参数为html标签名或组件类，第二个参数是属性配置，第三个参数是子节点或数组。更多API示例如下：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">renderArticle</span>(<span class="cm-def">article</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">// 可以返回数组，嵌套的数组会被扁平化</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> [</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">// 没有属性配置时，子节点可作为第二个参数</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Extag</span>.<span class="cm-property">node</span>(<span class="cm-string">'h'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">article</span>.<span class="cm-property">level</span>, <span class="cm-variable-2">article</span>.<span class="cm-property">title</span>), </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Extag</span>.<span class="cm-property">node</span>(<span class="cm-string">'p'</span>, {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">title</span>: <span class="cm-variable-2">article</span>.<span class="cm-property">title</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">style</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">fontSize</span>: <span class="cm-string">'15px'</span> <span class="cm-comment">// 样式名采用camelCase写法</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      }, </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">attrs</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-string">'data-sth'</span>: <span class="cm-string">'...'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">classes</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">'article-overview'</span>: <span class="cm-atom">true</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-comment">//, className: 'article-overview'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }, <span class="cm-variable-2">article</span>.<span class="cm-variable">overview</span>),</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">// 组件类作为第一个参数</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Extag</span>.<span class="cm-property">node</span>(<span class="cm-variable">ImageBox</span>, {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-comment">// 元素、组件特性名统一采用camelCase写法</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">imgSrc</span>: <span class="cm-variable-2">article</span>.<span class="cm-property">imgSrc</span>, </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-comment">// 事件监听，参考on方法</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">events</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-property">click</span>: <span class="cm-keyword">this</span>.<span class="cm-property">onClickImage</span>.<span class="cm-property">bind</span>(<span class="cm-keyword">this</span>),</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-property">dbclcik</span>: [<span class="cm-keyword">this</span>.<span class="cm-property">onDbclickImage</span>.<span class="cm-property">bind</span>(<span class="cm-keyword">this</span>), {<span class="cm-property">once</span>: <span class="cm-atom">true</span>, <span class="cm-property">capture</span>: <span class="cm-atom">true</span>}]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      } </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    })</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  ]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div></div></div>
      <div class="tip-box">
        <p>使用<span class="expr">Extag.node</span>，组件特性名、元素属性名和样式名统一采用<span class="expr">camelCase</span>写法。</p>
        <p>对于元素，data-*之类的自定义attribute，建议放到属性配置的<span class="expr">attrs</span>中，不使用<span class="expr">camelCase</span>写法。</p>
        <p>对于组件，<span class="expr">Extag.node</span>的第二个参数只用来对组件特性进行赋值和添加事件监听，而不能对DOM属性进行赋值。</p>
      </div>
      <h3 id="camelCase-vs-kebab-case">camelCase v.s. kebab-case</h3>
      <p>HTML特性不区分大小写，由HTML提供模板时，书写组件的特性名，应由<span class="expr">camelCase</span>转换为<span class="expr">kebab-case</span>。例如：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">ImgBox</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">attributes</span>: [<span class="cm-string">'imgSrc'</span>],</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>: <span class="cm-string">'&lt;div class="img-box"&gt;&lt;img src@="imgSrc"&gt;&lt;/div&gt;'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre></div></div></div><p></p><div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--父组件模板--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">&lt;!--</span><span class="cm-comment">特性imgSrc在这里写成img-src--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">x:type</span>=<span class="cm-string">"ImgBox"</span> <span class="cm-attribute">img-src</span>=<span class="cm-string">"/pic.png"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  ...</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p>而直接使用字符串模板，组件特性名可直接写成<span class="expr">camelCase</span>的，首字母大写的组件名也可直接作为标签名。例如：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>: <span class="cm-string">'&lt;div&gt;...&lt;ImgBox imgSrc="/pic.png"&gt;&lt;/ImgBox&gt;...&lt;/div&gt;'</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">resources</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">ImgBox</span>: <span class="cm-variable">ImgBox</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">// ...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre></div></div></div>
      <p>当然，你也可以在字符串模板中使用<span class="expr">kebab-case</span>的特性名。无论哪种模板，解析时特性名都将由<span class="expr">kebab-case</span>转换为<span class="expr">camelCase</span>，已经是<span class="expr">camelCase</span>的则无需转换。样式名亦如此，事件名亦如此。</p>
      <p>对于DOM元素原生的属性，大部分DOM属性名和特性名都统一为完全小写形式的。而有一些DOM属性名虽是<span class="expr">camelCase</span>的，但其对应特性名通常却是完全小写的，如readOnly。另有一些DOM属性，它们的属性名在HTML与JS之间，存在特别的转换关系。例如：</p>
      <!-- <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'for'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'htmlFor'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'class'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'className'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'readonly'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'readOnly'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'inner-html'</span> <span class="cm-operator">=&gt;</span> <span class="cm-string">'innerHTML'</span></span></pre></div></div></div> -->
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// kebab-case &lt;=&gt; camelCase</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'accept-charset'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'acceptCharset'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// lowercase &lt;=&gt; lowercase</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'autocomplete'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'autocomplete'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'autofocus'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'autofocus'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// lowercase &lt;=&gt; camelCase</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'readonly'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'readOnly'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'tabindex'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'tabIndex'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// specially</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'for'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'htmlFor'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'float'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'cssFloat'</span> <span class="cm-comment">// 样式属性</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'class'</span> <span class="cm-operator">&lt;=&gt;</span> <span class="cm-string">'className'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">'inner-html'</span> <span class="cm-operator">=&gt;</span> <span class="cm-string">'innerHTML'</span></span></pre></div></div></div>
      <p>其中，<span class="expr">inner-html</span>不是DOM元素原生的特性，而是Extag为所有标签元素特别添加的自定义特性。</p>
      <!-- <div class="tip-box"><p>模板标签上出现的特性通常对应组件的特性或元素的DOM属性。对于那些重要的DOM属性，如checked、innerHTML，ExtagDom直接对其赋值，否则使用setAttribute方法进行赋值。模板中名称带有冒号<span class="expr">:</span>的特性，一部分是Extag提供的控制特性，如<span class="expr">x:if</span>等，另一部分则都将直接被当作组件、元素的attrs，如<span class="expr">xlink:href</span>等，ExtagDom直接使用setAttribute方法进行赋值。对于data-*之类的自定义attribute，建议在模板中写为<span class="expr">:data-="..."</span></p></div> -->
      <div class="tip-box">
        <p>注意，模板中带有冒号<span class="expr">:</span>的特性名，具有命名空间，解析时不会由<span class="expr">kebab-case</span>转换为<span class="expr">camelCase</span>。除了<span class="expr">x:if</span>等控制特性，这些名称带冒号<span class="expr">:</span>的特性，如<span class="expr">xlink:href</span>等，都将直接被当作组件、元素的<span class="expr">attrs</span>，ExtagDom直接使用<span class="expr">setAttribute</span>方法进行赋值。对于data-*之类的自定义attribute，建议在模板中写为<span class="expr">:data-sth="..."</span>。参见<a href="./component.html#props-attrs-style-and-classes" class="link">props v.s. attrs</a>。</p>
      </div>
      <h3 id="tag-namespace">标签命名空间</h3>
      <p>对于一般的html标签元素，如div、p等，不必特意标明其命名空间，默认即为html。而对于svg元素、math元素以及它们的子节点，则应当标明其所属的命令空间，以便实际渲染时使用<span class="expr">document.createElementNS</span>方法创建元素，否则它们就被当成html空间下的自定义标签元素。只需在根元素上使用<span class="expr">xmlns</span>或<span class="expr">x:ns</span>特性，即可标明它们及其子节点的命名空间。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">svg</span> <span class="cm-attribute">xmlns</span>=<span class="cm-string">"http://www.w3.org/2000/svg"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">svg</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-comment">&lt;!--简写为--&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">svg</span> <span class="cm-attribute">x:ns</span>=<span class="cm-string">"svg"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">svg</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">math</span> <span class="cm-attribute">xmlns</span>=<span class="cm-string">"http://www.w3.org/1998/Math/MathML"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">math</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-comment">&lt;!--简写为--&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">math</span> <span class="cm-attribute">x:ns</span>=<span class="cm-string">"math"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">math</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p>如果以svg某个子元素作为自定义组件模板根标签的话，也应当在根标签上使用<span class="expr">xmlns</span>或<span class="expr">x:ns</span>特性标明其命名空间。例如：</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>: <span class="cm-string">'&lt;g x:ns="svg"&gt;...&lt;/g&gt;'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre></div></div></div>
      <h3 id="variable-identifier">变量标识符</h3>
      <p>模板表达式除了可以访问组件本身的属性和方法外，还可以访问本地静态<span class="expr">resources</span>中注册的资源，包括其他子组件类、预定义的常量和方法。解析模板表达式时，当遇到一个变量标识符，如<span class="expr">foo</span>，如果它不是JS关键字（如<span class="expr">this</span>）和常用全局变量，也不是<span class="expr">x:for</span>表达式中迭代变量，则判断它是不是<span class="expr">resources</span>中注册的资源。
        如果是的，则令<span class="expr">var foo = this.constructor.resources.foo</span>；如果不是的，则认为是组件本身的属性或方法，并替换<span class="expr">foo</span>为<span class="expr">this.foo</span>。</p>
      
      <div class="tip-box">
        <p>模板表达式中可识别的JS常用全局变量：<span class="expr">Array, Date, Infinity, Math, NaN, Number, Object, String, Boolean</span>。你可以通过<span class="expr">resources</span>向模板中引入其他需要的全局变量。</p>
      </div>
      <!-- <div class="tip-box">
        <p>模板表达式中对组件自身函数方法的调用，<span class="expr">this.</span>通常不可省略，除非<span class="expr">setup</span>的时候组件函数方法已绑定到<span class="expr">this</span>上。</p>
      </div> -->
      <p></p>
    </article>
    
  </div>
  <script src="../javascripts/extag-dom.js"></script>
  <script src="../javascripts/extag.js"></script>
  <script src="../javascripts/common.js"></script>
  
</body>