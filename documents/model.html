<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
  <link href="../stylesheets/codemirror.css" rel="stylesheet">
  <link href="../stylesheets/alicestyle.css" rel="stylesheet">
  <link href="../stylesheets/common.css" rel="stylesheet">
  

  <title>数据模型 - Extag</title>
</head>
<body>
  <div class="main">
    <aside class="side-bar"></aside>
    <article class="article">
      <h2>数据模型</h2>
      <h3 id="store-for-object">Store for Object</h3>
      <p>如果没有特殊要求，你可以直接使用普通的Object来为组件提供数据。如果需要观察数据对象内部属性的变化，能够在组件模板中形成绑定关系，则可以使用Extag提供的Store。在构造Store实例时，提供一些初始属性值给Store的构造函数，即可为这个实例创建相应的getter/setter。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">point</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Extag</span>.<span class="cm-property">Store</span>({<span class="cm-property">x</span>:<span class="cm-number">0</span>, <span class="cm-property">y</span>: <span class="cm-number">0</span>, <span class="cm-property">z</span>:<span class="cm-number">0</span>});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">on</span>(<span class="cm-string">'changed'</span>, <span class="cm-keyword">function</span>(<span class="cm-def">key</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">'changed.'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">key</span>, <span class="cm-variable">point</span>[<span class="cm-variable-2">key</span>]);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">x</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>;<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">// 输出：changed.x 1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">y</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>;<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">// 输出：changed.y 2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">z</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>;<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">// 输出：changed.z 3</span></span></pre></div></div></div>
      <p>同Component一样，Store具有良好的可扩展性，继承时支持attributes声明和验证。Store子类只在第一次实例化时，才会在子类prototype上为声明的attributes创建getter/setter。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">Point</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Store</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-property">attributes</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">          <span class="cm-property">x</span>: {<span class="cm-property">type</span>: <span class="cm-string">'number'</span>, <span class="cm-property">value</span>: <span class="cm-number">0</span>},</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">          <span class="cm-property">y</span>: {<span class="cm-property">type</span>: <span class="cm-string">'number'</span>, <span class="cm-property">value</span>: <span class="cm-number">0</span>},</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">          <span class="cm-property">z</span>: {<span class="cm-property">type</span>: <span class="cm-string">'number'</span>, <span class="cm-property">value</span>: <span class="cm-number">0</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">toString</span>: <span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">return</span> <span class="cm-string">'('</span> <span class="cm-operator">+</span> <span class="cm-keyword">this</span>.<span class="cm-property">x</span> <span class="cm-operator">+</span> <span class="cm-string">', '</span> <span class="cm-operator">+</span> <span class="cm-keyword">this</span>.<span class="cm-property">y</span> <span class="cm-operator">+</span> <span class="cm-string">', '</span> <span class="cm-operator">+</span> <span class="cm-keyword">this</span>.<span class="cm-property">z</span>  <span class="cm-operator">+</span> <span class="cm-string">')'</span>;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">point</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Point</span>(); <span class="cm-comment">// 在Point.prototype上为声明的attributes创建getter/setter</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">on</span>(<span class="cm-string">'changed'</span>, <span class="cm-keyword">function</span>(<span class="cm-def">key</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">'changed.'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">key</span>, <span class="cm-variable">point</span>.<span class="cm-property">toString</span>());</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">x</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>;            <span class="cm-comment">// 输出：changed.x (1, 0, 0)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-property">set</span>(<span class="cm-string">'y'</span>, <span class="cm-number">2</span>);      <span class="cm-comment">// 输出：changed.y (1, 2, 0)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">point</span>.<span class="cm-variable">assign</span>({<span class="cm-variable">z</span>: <span class="cm-number">3</span>});   <span class="cm-comment">// 输出：changed.z (1, 2, 3)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">point2</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Point</span>(); <span class="cm-comment">// 不用为声明的attributes二次创建getter/setter</span></span></pre></div></div></div>
      <div class="tip-box"><p>对于Array，Extag没有提供类似的包装。当数组长度变化或某些索引处的元素发生了替换时，可返回新的数组，以替换旧的数组，相关的绑定才会生效。</p></div>
    </article>
  </div>
  <script src="../javascripts/extag-dom.js"></script>
  <script src="../javascripts/extag.js"></script>
  <script src="../javascripts/common.js"></script>
</body>