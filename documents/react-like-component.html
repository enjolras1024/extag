<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
  <link href="../stylesheets/codemirror.css" rel="stylesheet">
  <link href="../stylesheets/alicestyle.css" rel="stylesheet">
  <link href="../stylesheets/common.css" rel="stylesheet">

  <title>类React组件 - Extag</title>
</head>
<body>
  <div class="main">
    <aside class="side-bar"></aside>
    <article class="article">
      <h2>类React组件</h2>
      <p>如果定义组件时没有声明模板，而是提供了render方法，那么该组件的模板默认为</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">x:frag</span><span class="cm-tag cm-bracket">&gt;</span>@{{ <span class="cm-keyword">this</span>.<span class="cm-property">render</span>(<span class="cm-keyword">this</span>.<span class="cm-property">_props</span>) <span class="cm-operator">^</span>}}<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">x:frag</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div>
      <p>Extag会在每次更新时调用render方法，利用其返回的虚拟节点树，通过diff的方式更新该组件的所有子节点。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**@jsx Extag.node*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">Hello</span> <span class="cm-keyword">extends</span> <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-property">render</span>(<span class="cm-def">props</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">h2</span><span class="cm-tag cm-bracket">&gt;</span>Hello, {<span class="cm-variable">props</span>.<span class="cm-property">name</span>}!<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">h2</span><span class="cm-tag cm-bracket">&gt;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">new</span> <span class="cm-variable">Extag</span>.<span class="cm-property">Element</span>({<span class="cm-property">tag</span>: <span class="cm-string">'div'</span>, <span class="cm-property">contents</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">Hello</span> <span class="cm-attribute">name</span>=<span class="cm-string">"World"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">Hello</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">]}).<span class="cm-property">attach</span>(<span class="cm-variable">ExtagDOM</span>.<span class="cm-property">query</span>(<span class="cm-string">'#container'</span>));</span></pre></div></div></div>
      <div class="tip-box">
        <p>Demo的根标签为<span class="expr">&lt;x:frag&gt;</span>，因而不能直接attach DOM元素。</p>
      </div>
      <p>你可能想在模板中直接使用渲染函数作为组件。Extag允许配置hook-engine，只要实现<span class="expr">getHookableComponentClass</span>方法，返回对渲染函数包装后的组件类即可。</p>
      <div class="code-box scroll"><div class="CodeMirror cm-s-alice"><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**@jsx Extag.node*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">(<span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">let</span> <span class="cm-def">currComponent</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">Extag</span>.<span class="cm-property">conf</span>(<span class="cm-string">'hook-engine'</span>, {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-property">getHookableComponentClass</span>(<span class="cm-def">render</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-keyword">if</span> (<span class="cm-operator">!</span><span class="cm-variable-2">render</span>.<span class="cm-property">__extag_hookable__</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable-2">render</span>.<span class="cm-property">__extag_hookable__</span> <span class="cm-operator">=</span> <span class="cm-variable">Extag</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-property">extends</span>: <span class="cm-variable">Extag</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-property">render</span>: <span class="cm-keyword">function</span>(<span class="cm-def">props</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable-2">currComponent</span> <span class="cm-operator">=</span> <span class="cm-keyword">this</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-keyword">return</span> <span class="cm-variable-2">render</span>(<span class="cm-variable-2">props</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-keyword">return</span> <span class="cm-variable-2">render</span>.<span class="cm-property">__extag_hookable__</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// class Hello extends Extag.Component {</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//   render(props) {</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//     return &lt;h2&gt;Hello, {props.name}!&lt;/h2&gt; </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//   }</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// }</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">Hello</span>(<span class="cm-def">props</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">h2</span><span class="cm-tag cm-bracket">&gt;</span>Hello, {<span class="cm-variable">props</span>.<span class="cm-property">name</span>}!<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">h2</span><span class="cm-tag cm-bracket">&gt;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">new</span> <span class="cm-variable">Extag</span>.<span class="cm-property">Element</span>({<span class="cm-property">tag</span>: <span class="cm-string">'div'</span>, <span class="cm-property">contents</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">Hello</span> <span class="cm-attribute">name</span>=<span class="cm-string">"World"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">Hello</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">]}).<span class="cm-property">attach</span>(<span class="cm-variable">ExtagDOM</span>.<span class="cm-property">query</span>(<span class="cm-string">'#container'</span>));</span></pre></div></div></div>
      <div class="tip-box">
        <p>在此基础上，进一步可实现useState等钩子函数。</p>
      </div>
      <p>
        <a class="link" href="https://codepen.io/enjolras1024/pen/gOwZVxz" target="_blank">
          在CodePen上尝试
        </a>
      </p>
    </article>
  </div>

  <script src="../javascripts/extag-dom.js"></script>
  <script src="../javascripts/extag.js"></script>
  <script src="../javascripts/common.js"></script>
  <script>
    
    
  </script>
</body>